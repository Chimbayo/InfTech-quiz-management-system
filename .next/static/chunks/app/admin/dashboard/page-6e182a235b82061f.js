(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{8552:function(e,s,t){Promise.resolve().then(t.bind(t,584))},584:function(e,s,t){"use strict";t.d(s,{EnhancedAdminDashboard:function(){return B}});var a=t(7437),r=t(2265),l=t(3795),i=t(9376),n=t(2381),c=t(9820),d=t(9174),o=t(279),x=t(5060),m=t(7168),h=t(8906),u=t(7692),j=t(6221),g=t(1769),p=t(5805),f=t(3417),N=t(6439),b=t(4972),v=t(8896),y=t(525),w=t(9397),z=t(4630),S=t(8930),Z=t(3639),C=t(2208),k=t(7806),A=t(4766),I=t(5291),q=t(4401),E=t(3327),R=t(1723);function O(){var e;let[s,t]=(0,r.useState)(null),[l,i]=(0,r.useState)("30"),[o,x]=(0,r.useState)("all"),[m,h]=(0,r.useState)([]),[u,g]=(0,r.useState)(!0);(0,r.useEffect)(()=>{N(),v()},[]),(0,r.useEffect)(()=>{v()},[l,o]);let N=async()=>{try{let e=await fetch("/api/quizzes");if(e.ok){let s=await e.json();h(s)}}catch(e){console.error("Error fetching quizzes:",e)}},v=async()=>{g(!0);try{let e=new URLSearchParams({timeRange:l,...o&&"all"!==o&&{quizId:o}}),s=await fetch("/api/analytics/learning?".concat(e));if(s.ok){let e=await s.json();t(e)}}catch(e){console.error("Error fetching analytics:",e)}finally{g(!1)}},w=e=>e>.7?"text-green-600":e>.3?"text-yellow-600":"text-red-600",z=e=>{let s=Object.entries(e);if(0===s.length)return"N/A";let t=s.reduce((e,s)=>{let[t,a]=s;return a>e.count?{hour:parseInt(t),count:a}:e},{hour:0,count:0});return"".concat(t.hour,":00")};return u?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-2",children:"Loading analytics..."})]}):s?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Learning Analytics Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Analyze engagement patterns and learning effectiveness"})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)(I.Ph,{value:l,onValueChange:i,children:[(0,a.jsx)(I.i4,{className:"w-40",children:(0,a.jsx)(I.ki,{placeholder:"Time Range"})}),(0,a.jsxs)(I.Bw,{children:[(0,a.jsx)(I.Ql,{value:"7",children:"Last 7 days"}),(0,a.jsx)(I.Ql,{value:"30",children:"Last 30 days"}),(0,a.jsx)(I.Ql,{value:"90",children:"Last 90 days"}),(0,a.jsx)(I.Ql,{value:"365",children:"Last year"})]})]}),(0,a.jsxs)(I.Ph,{value:o,onValueChange:x,children:[(0,a.jsx)(I.i4,{className:"w-48",children:(0,a.jsx)(I.ki,{placeholder:"All Quizzes"})}),(0,a.jsxs)(I.Bw,{children:[(0,a.jsx)(I.Ql,{value:"all",children:"All Quizzes"}),m.map(e=>(0,a.jsx)(I.Ql,{value:e.id,children:e.title},e.id))]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Active Users"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:s.summary.totalUsers})]}),(0,a.jsx)(p.Z,{className:"h-8 w-8 text-blue-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total Messages"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:s.summary.totalMessages.toLocaleString()})]}),(0,a.jsx)(f.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Avg Engagement"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:Math.round(s.summary.averageEngagement)}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"messages/user"})]}),(0,a.jsx)(q.Z,{className:"h-8 w-8 text-purple-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Correlation"}),(0,a.jsxs)("p",{className:"text-3xl font-bold ".concat(w(s.summary.correlationStrength)),children:[(100*s.summary.correlationStrength).toFixed(0),"%"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"chat-performance"})]}),(0,a.jsx)(y.Z,{className:"h-8 w-8 text-orange-500"})]})})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(j.Z,{className:"h-5 w-5"}),"Chat Engagement vs Quiz Performance"]}),(0,a.jsx)(c.SZ,{children:"Correlation between chat participation and quiz scores"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)(d.C,{className:w(s.summary.correlationStrength),children:[(e=s.summary.correlationStrength)>.7?"Strong Positive":e>.3?"Moderate Positive":e>-.3?"Weak/No Correlation":e>-.7?"Moderate Negative":"Strong Negative"," Correlation"]})}),(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"High Engagement (> 50 messages)"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:s.engagementCorrelation.filter(e=>e.messageCount>50).length}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"users"})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"High Performers (>80% avg)"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:s.engagementCorrelation.filter(e=>e.averageScore>80).length}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"users"})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Both High Engagement & Performance"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:s.engagementCorrelation.filter(e=>e.messageCount>50&&e.averageScore>80).length}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"users"})]})]})})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5"}),"Study Group Effectiveness"]}),(0,a.jsx)(c.SZ,{children:"Performance metrics for study groups"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:s.studyGroupEffectiveness.map(e=>(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsx)("h4",{className:"font-semibold",children:e.groupName}),(0,a.jsxs)(d.C,{variant:e.passRate>.8?"default":e.passRate>.6?"secondary":"destructive",children:[(100*e.passRate).toFixed(0),"% Pass Rate"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Members"}),(0,a.jsx)("p",{className:"font-semibold",children:e.memberCount})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Avg Score"}),(0,a.jsxs)("p",{className:"font-semibold",children:[e.averageScore.toFixed(1),"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Total Messages"}),(0,a.jsx)("p",{className:"font-semibold",children:e.totalMessages})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Messages/Member"}),(0,a.jsx)("p",{className:"font-semibold",children:e.messagesPerMember.toFixed(1)})]})]})]},e.groupId))})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(b.Z,{className:"h-5 w-5"}),"Peer Learning Insights"]}),(0,a.jsx)(c.SZ,{children:"Questions asked and help provided by students"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-3",children:"Most Active Help Seekers"}),(0,a.jsx)("div",{className:"space-y-2",children:Object.entries(s.peerInteractions).sort((e,s)=>{let[,t]=e,[,a]=s;return a.questionsAsked-t.questionsAsked}).slice(0,5).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"font-medium",children:t.userName}),(0,a.jsxs)(d.C,{variant:"outline",children:[t.questionsAsked," questions"]})]},s)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-3",children:"Top Peer Helpers"}),(0,a.jsx)("div",{className:"space-y-2",children:Object.entries(s.peerInteractions).sort((e,s)=>{let[,t]=e,[,a]=s;return a.helpProvided-t.helpProvided}).slice(0,5).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,a.jsx)("span",{className:"font-medium",children:t.userName}),(0,a.jsxs)(d.C,{variant:"outline",children:[t.helpProvided," helps"]})]},s)})})]})]})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(E.Z,{className:"h-5 w-5"}),"Teacher Intervention Analysis"]}),(0,a.jsx)(c.SZ,{children:"Teacher engagement and intervention patterns"})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:s.teacherInterventions.total}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total teacher interventions"})]}),(0,a.jsx)("div",{className:"space-y-3",children:Object.entries(s.teacherInterventions.byTeacher).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"flex justify-between items-center p-3 border rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:t.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Active in ",Array.from(t.rooms).length," rooms"]})]}),(0,a.jsxs)(d.C,{children:[t.interventions," interventions"]})]},s)})})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(R.Z,{className:"h-5 w-5"}),"Study Pattern Analysis"]}),(0,a.jsx)(c.SZ,{children:"When and how students engage in discussions"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(s.userStudyPatterns).slice(0,6).map(e=>{let[s,t]=e;return(0,a.jsx)("div",{className:"border rounded-lg p-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Total Messages"}),(0,a.jsx)("span",{className:"font-semibold",children:t.totalMessages})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Quiz Discussions"}),(0,a.jsx)("span",{className:"font-semibold",children:t.quizDiscussionMessages})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Study Groups"}),(0,a.jsx)("span",{className:"font-semibold",children:t.studyGroupMessages})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Peak Hour"}),(0,a.jsx)("span",{className:"font-semibold",children:z(t.peakHours)})]})]})},s)})})})]})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Failed to load analytics data"}),(0,a.jsx)(n.z,{onClick:v,className:"mt-4",children:"Retry"})]})}var Q=t(5937),P=t(9663),M=t(5846);function L(){let[e,s]=(0,r.useState)(null),[t,l]=(0,r.useState)(!0),[i,o]=(0,r.useState)("90"),[x,m]=(0,r.useState)("ALL");(0,r.useEffect)(()=>{h()},[i]);let h=async()=>{l(!0);try{let e=await fetch("/api/analytics/predictive?timeRange=".concat(i));if(e.ok){let t=await e.json();s(t)}}catch(e){console.error("Error fetching predictive analytics:",e)}finally{l(!1)}},u=e=>{switch(e){case"HIGH":return"bg-red-100 text-red-800 border-red-200";case"MEDIUM":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"LOW":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},j=e=>{switch(e){case"HIGH":return"bg-red-500";case"MEDIUM":return"bg-yellow-500";case"LOW":return"bg-blue-500";default:return"bg-gray-500"}},g=e=>e>=75?"text-green-600":e>=50?"text-yellow-600":"text-red-600",N=(null==e?void 0:e.predictions.filter(e=>"ALL"===x||e.predictions.riskLevel===x))||[];return t?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-2",children:"Analyzing student data..."})]}):e?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Predictive Analytics Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600",children:"AI-powered insights for student success prediction"})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)(I.Ph,{value:i,onValueChange:o,children:[(0,a.jsx)(I.i4,{className:"w-40",children:(0,a.jsx)(I.ki,{placeholder:"Time Range"})}),(0,a.jsxs)(I.Bw,{children:[(0,a.jsx)(I.Ql,{value:"30",children:"Last 30 days"}),(0,a.jsx)(I.Ql,{value:"60",children:"Last 60 days"}),(0,a.jsx)(I.Ql,{value:"90",children:"Last 90 days"}),(0,a.jsx)(I.Ql,{value:"180",children:"Last 6 months"})]})]}),(0,a.jsxs)(I.Ph,{value:x,onValueChange:m,children:[(0,a.jsx)(I.i4,{className:"w-40",children:(0,a.jsx)(I.ki,{placeholder:"Risk Level"})}),(0,a.jsxs)(I.Bw,{children:[(0,a.jsx)(I.Ql,{value:"ALL",children:"All Students"}),(0,a.jsx)(I.Ql,{value:"HIGH",children:"High Risk"}),(0,a.jsx)(I.Ql,{value:"MEDIUM",children:"Medium Risk"}),(0,a.jsx)(I.Ql,{value:"LOW",children:"Low Risk"})]})]})]})]}),e.earlyWarnings.length>0&&(0,a.jsx)("div",{className:"space-y-3",children:e.earlyWarnings.map((e,s)=>(0,a.jsxs)(Q.bZ,{className:"HIGH"===e.severity?"border-red-500 bg-red-50":"border-yellow-500 bg-yellow-50",children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4"}),(0,a.jsxs)(Q.X,{children:[(0,a.jsx)("strong",{children:e.message}),(0,a.jsxs)("details",{className:"mt-2",children:[(0,a.jsx)("summary",{className:"cursor-pointer text-sm text-blue-600 hover:underline",children:"View affected students"}),(0,a.jsx)("div",{className:"mt-1 text-sm",children:e.students.join(", ")})]})]})]},s))}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total Students"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:e.summary.totalStudents})]}),(0,a.jsx)(p.Z,{className:"h-8 w-8 text-blue-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"High Risk"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-red-600",children:e.summary.highRiskStudents})]}),(0,a.jsx)(Z.Z,{className:"h-8 w-8 text-red-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Medium Risk"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-yellow-600",children:e.summary.mediumRiskStudents})]}),(0,a.jsx)(R.Z,{className:"h-8 w-8 text-yellow-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Low Risk"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-green-600",children:e.summary.lowRiskStudents})]}),(0,a.jsx)(P.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Avg Success Rate"}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-purple-600",children:[Math.round(e.summary.averageSuccessProbability),"%"]})]}),(0,a.jsx)(v.Z,{className:"h-8 w-8 text-purple-500"})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(y.Z,{className:"h-5 w-5"}),"Performance Distribution"]})}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm",children:"Excellent (90%+)"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"".concat(e.cohortInsights.performanceDistribution.excellent/e.summary.totalStudents*100,"%")}})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:e.cohortInsights.performanceDistribution.excellent})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm",children:"Good (80-89%)"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"".concat(e.cohortInsights.performanceDistribution.good/e.summary.totalStudents*100,"%")}})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:e.cohortInsights.performanceDistribution.good})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm",children:"Average (70-79%)"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-yellow-500 h-2 rounded-full",style:{width:"".concat(e.cohortInsights.performanceDistribution.average/e.summary.totalStudents*100,"%")}})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:e.cohortInsights.performanceDistribution.average})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm",children:"Below Average (<70%)"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-red-500 h-2 rounded-full",style:{width:"".concat(e.cohortInsights.performanceDistribution.belowAverage/e.summary.totalStudents*100,"%")}})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:e.cohortInsights.performanceDistribution.belowAverage})]})]})]})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(f.Z,{className:"h-5 w-5"}),"Engagement Insights"]})}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Chat-Performance Correlation"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:[(100*e.cohortInsights.correlation.chatEngagementVsPerformance).toFixed(0),"%"]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[e.cohortInsights.correlation.strength," correlation"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Study Group Participation"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-green-600",children:[Math.round(100*e.cohortInsights.trends.studyGroupParticipation),"%"]})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Avg Improvement"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-purple-600",children:[e.cohortInsights.trends.averageImprovement>0?"+":"",e.cohortInsights.trends.averageImprovement.toFixed(1),"%"]})]})]})]})})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(b.Z,{className:"h-5 w-5"}),"Student Success Predictions"]}),(0,a.jsx)(c.SZ,{children:"AI-powered analysis of individual student success probability"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:N.slice(0,20).map(e=>(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold",children:e.student.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.student.email})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(d.C,{className:u(e.predictions.riskLevel),children:[e.predictions.riskLevel," RISK"]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-lg font-bold ".concat(g(e.predictions.successProbability)),children:[e.predictions.successProbability,"%"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Success Rate"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Quiz Performance"}),(0,a.jsxs)("p",{className:"text-lg font-bold",children:[e.metrics.performanceMetrics.averageScore.toFixed(1),"%"]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[e.metrics.performanceMetrics.totalAttempts," attempts"]})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Chat Engagement"}),(0,a.jsx)("p",{className:"text-lg font-bold",children:Math.round(e.metrics.chatEngagement.engagementScore)}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[e.metrics.chatEngagement.totalMessages," messages"]})]}),(0,a.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Next Quiz Prediction"}),(0,a.jsxs)("p",{className:"text-lg font-bold",children:[e.predictions.nextQuizSuccessRate,"%"]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Expected score"})]})]}),e.riskFactors.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h5",{className:"text-sm font-semibold mb-2",children:"Risk Factors:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.riskFactors.map((e,s)=>(0,a.jsx)(d.C,{variant:"outline",className:"text-xs",children:e.description},s))})]}),e.interventions.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h5",{className:"text-sm font-semibold mb-2 flex items-center gap-1",children:[(0,a.jsx)(M.Z,{className:"h-4 w-4"}),"Recommended Interventions:"]}),(0,a.jsx)("div",{className:"space-y-2",children:e.interventions.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start space-x-2 text-sm",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full mt-2 ".concat(j(e.priority))}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.action}),(0,a.jsx)("p",{className:"text-gray-600 text-xs",children:e.description})]})]},s))})]})]},e.student.id))})})]})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Failed to load predictive analytics"}),(0,a.jsx)(n.z,{onClick:h,className:"mt-4",children:"Retry"})]})}var Y=t(6744),T=t(5131),U=t(5302),D=t(8736);function _(){var e,s;let[t,l]=(0,r.useState)(null),[i,o]=(0,r.useState)(!0),[x,m]=(0,r.useState)("30"),[u,j]=(0,r.useState)("all"),[g,f]=(0,r.useState)([]);(0,r.useEffect)(()=>{N(),b()},[]),(0,r.useEffect)(()=>{b()},[x,u]);let N=async()=>{try{let e=await fetch("/api/quizzes");if(e.ok){let s=await e.json();f(s)}}catch(e){console.error("Error fetching quizzes:",e)}},b=async()=>{o(!0);try{let e=new URLSearchParams({timeRange:x,...u&&"all"!==u&&{quizId:u}}),s=await fetch("/api/reports/academic-integrity?".concat(e));if(s.ok){let e=await s.json();l(e)}}catch(e){console.error("Error generating report:",e)}finally{o(!1)}},v=e=>{switch(e){case"HIGH":return"bg-red-100 text-red-800 border-red-200";case"MEDIUM":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"LOW":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},y=e=>{switch(e){case"HIGH":return"bg-red-100 text-red-800";case"MEDIUM":return"bg-yellow-100 text-yellow-800";case"LOW":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return i?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-2",children:"Generating integrity report..."})]}):t?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Academic Integrity Report"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Comprehensive analysis of academic integrity violations"})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)(I.Ph,{value:x,onValueChange:m,children:[(0,a.jsx)(I.i4,{className:"w-40",children:(0,a.jsx)(I.ki,{placeholder:"Time Range"})}),(0,a.jsxs)(I.Bw,{children:[(0,a.jsx)(I.Ql,{value:"7",children:"Last 7 days"}),(0,a.jsx)(I.Ql,{value:"30",children:"Last 30 days"}),(0,a.jsx)(I.Ql,{value:"90",children:"Last 90 days"}),(0,a.jsx)(I.Ql,{value:"365",children:"Last year"})]})]}),(0,a.jsxs)(I.Ph,{value:u,onValueChange:j,children:[(0,a.jsx)(I.i4,{className:"w-48",children:(0,a.jsx)(I.ki,{placeholder:"All Quizzes"})}),(0,a.jsxs)(I.Bw,{children:[(0,a.jsx)(I.Ql,{value:"all",children:"All Quizzes"}),g.map(e=>(0,a.jsx)(I.Ql,{value:e.id,children:e.title},e.id))]})]}),(0,a.jsxs)(n.z,{onClick:b,variant:"outline",children:[(0,a.jsx)(Y.Z,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),(0,a.jsx)(c.Zb,{className:"".concat((e=t.integrityScore.score)>=90?"bg-green-100":e>=75?"bg-blue-100":e>=60?"bg-yellow-100":e>=40?"bg-orange-100":"bg-red-100"," border-2"),children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Overall Integrity Score"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:t.integrityScore.description}),(0,a.jsx)(d.C,{className:v(t.integrityScore.level),children:t.integrityScore.level})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-6xl font-bold ".concat((s=t.integrityScore.score)>=90?"text-green-600":s>=75?"text-blue-600":s>=60?"text-yellow-600":s>=40?"text-orange-600":"text-red-600"),children:t.integrityScore.score}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"out of 100"})]})]})})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total Violations"}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:t.summary.totalViolations})]}),(0,a.jsx)(Z.Z,{className:"h-8 w-8 text-red-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"High Severity"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-red-600",children:t.summary.highSeverityViolations})]}),(0,a.jsx)(T.Z,{className:"h-8 w-8 text-red-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Affected Users"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-orange-600",children:t.summary.uniqueUsers})]}),(0,a.jsx)(p.Z,{className:"h-8 w-8 text-orange-500"})]})})}),(0,a.jsx)(c.Zb,{children:(0,a.jsx)(c.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Resolved"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-green-600",children:t.summary.resolvedViolations})]}),(0,a.jsx)(U.Z,{className:"h-8 w-8 text-green-500"})]})})})]}),t.quizAnalysis&&(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{children:["Quiz-Specific Analysis: ",t.quizAnalysis.quizTitle]})}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total Attempts"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:t.quizAnalysis.totalAttempts})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Compromised Attempts"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:t.quizAnalysis.compromisedAttempts})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Quiz Integrity"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:[Math.round(t.quizAnalysis.integrityScore),"%"]})]})]})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5"}),"High-Risk Users"]}),(0,a.jsx)(c.SZ,{children:"Users with elevated academic integrity concerns"})]}),(0,a.jsx)(c.aY,{children:0===t.userRiskAssessment.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(h.Z,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No high-risk users identified"})]}):(0,a.jsx)("div",{className:"space-y-4",children:t.userRiskAssessment.slice(0,10).map(e=>(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold",children:e.user.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.user.email})]}),(0,a.jsxs)(d.C,{className:v(e.riskLevel),children:[e.riskLevel," RISK"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"High Severity"}),(0,a.jsx)("p",{className:"font-semibold text-red-600",children:e.violations.high})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Medium Severity"}),(0,a.jsx)("p",{className:"font-semibold text-yellow-600",children:e.violations.medium})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Low Severity"}),(0,a.jsx)("p",{className:"font-semibold text-blue-600",children:e.violations.low})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Risk Score"}),(0,a.jsx)("p",{className:"font-semibold",children:e.riskScore})]})]})]},e.user.id))})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsx)(c.ll,{children:"Violations by Type"})}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"space-y-3",children:t.patternAnalysis.violationsByType.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e.type.replace("_"," ")}),(0,a.jsx)(d.C,{variant:"outline",children:e.count})]},e.type))})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsx)(c.ll,{children:"Repeat Offenders"})}),(0,a.jsx)(c.aY,{children:0===t.patternAnalysis.repeatOffenders.length?(0,a.jsx)("p",{className:"text-gray-600 text-center py-4",children:"No repeat offenders identified"}):(0,a.jsx)("div",{className:"space-y-3",children:t.patternAnalysis.repeatOffenders.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.user.name}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:e.user.email})]}),(0,a.jsxs)(d.C,{variant:"destructive",children:[e.violationCount," violations"]})]},e.userId))})})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(D.Z,{className:"h-5 w-5"}),"Recommendations"]}),(0,a.jsx)(c.SZ,{children:"Suggested actions to improve academic integrity"})]}),(0,a.jsx)(c.aY,{children:0===t.recommendations.length?(0,a.jsx)("p",{className:"text-gray-600",children:"No specific recommendations at this time"}):(0,a.jsx)("div",{className:"space-y-3",children:t.recommendations.map((e,s)=>(0,a.jsxs)(Q.bZ,{children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4"}),(0,a.jsx)(Q.X,{children:e})]},s))})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(R.Z,{className:"h-5 w-5"}),"Recent Violations"]}),(0,a.jsx)(c.SZ,{children:"Latest academic integrity concerns"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:t.suspiciousActivities.slice(0,10).map(e=>(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(d.C,{className:y(e.severity),children:e.severity}),(0,a.jsx)("span",{className:"font-medium",children:e.type.replace("_"," ")}),e.resolved&&(0,a.jsx)(d.C,{variant:"outline",className:"text-green-600 border-green-600",children:"Resolved"})]}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleString()})]}),(0,a.jsx)("p",{className:"text-sm text-gray-700 mb-2",children:e.description}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[(0,a.jsxs)("span",{children:["User: ",e.user.name]}),(0,a.jsxs)("span",{children:["Room: ",e.room.name]})]}),e.message&&(0,a.jsxs)("details",{className:"mt-2",children:[(0,a.jsx)("summary",{className:"text-xs text-blue-600 cursor-pointer hover:underline",children:"View Message"}),(0,a.jsx)("div",{className:"text-xs bg-gray-50 p-2 rounded mt-1",children:e.message.content})]})]},e.id))})})]})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Failed to generate report"}),(0,a.jsxs)(n.z,{onClick:b,className:"mt-4",children:[(0,a.jsx)(Y.Z,{className:"h-4 w-4 mr-2"}),"Retry"]})]})}var G=t(3448);let F=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("textarea",{className:(0,G.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...r})});F.displayName="Textarea";var V=t(4743);function H(){var e;let[s,t]=(0,r.useState)([]),[l,i]=(0,r.useState)([]),[o,m]=(0,r.useState)(!0),[h,u]=(0,r.useState)(!1),[j,f]=(0,r.useState)(""),[b,v]=(0,r.useState)(""),[y,w]=(0,r.useState)("GENERAL");(0,r.useEffect)(()=>{z(),S()},[]);let z=async()=>{try{let e=await fetch("/api/quizzes");if(e.ok){let s=await e.json();t(s)}}catch(e){console.error("Error fetching quizzes:",e)}},S=async()=>{try{let e=await fetch("/api/announcements?limit=20");if(e.ok){let s=await e.json();i(s)}}catch(e){console.error("Error fetching announcements:",e)}finally{m(!1)}},C=async()=>{if(j.trim()){u(!0);try{let e=await fetch("/api/announcements",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:j.trim(),type:y,quizId:b||void 0})});if(e.ok)f(""),v(""),w("GENERAL"),S(),alert("Announcement sent successfully!");else{let s=await e.json();alert("Failed to send announcement: ".concat(s.error))}}catch(e){console.error("Error sending announcement:",e),alert("Failed to send announcement")}finally{u(!1)}}},k=e=>{switch(e){case"QUIZ_SPECIFIC":return"bg-blue-100 text-blue-800";case"URGENT":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},A=e=>{switch(e){case"QUIZ_SPECIFIC":return(0,a.jsx)(g.Z,{className:"h-4 w-4"});case"URGENT":return(0,a.jsx)(Z.Z,{className:"h-4 w-4"});default:return(0,a.jsx)(N.Z,{className:"h-4 w-4"})}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(N.Z,{className:"h-5 w-5"}),"Send Quiz Announcement"]}),(0,a.jsx)(c.SZ,{children:"Broadcast important information to all students about quizzes or general updates"})]}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(x._,{htmlFor:"announcementType",children:"Announcement Type"}),(0,a.jsxs)(I.Ph,{value:y,onValueChange:w,children:[(0,a.jsx)(I.i4,{children:(0,a.jsx)(I.ki,{placeholder:"Select type"})}),(0,a.jsxs)(I.Bw,{children:[(0,a.jsx)(I.Ql,{value:"GENERAL",children:"General Announcement"}),(0,a.jsx)(I.Ql,{value:"QUIZ_SPECIFIC",children:"Quiz-Specific"}),(0,a.jsx)(I.Ql,{value:"URGENT",children:"Urgent Notice"})]})]})]}),"QUIZ_SPECIFIC"===y&&(0,a.jsxs)("div",{children:[(0,a.jsx)(x._,{htmlFor:"selectedQuiz",children:"Select Quiz"}),(0,a.jsxs)(I.Ph,{value:b,onValueChange:v,children:[(0,a.jsx)(I.i4,{children:(0,a.jsx)(I.ki,{placeholder:"Choose a quiz"})}),(0,a.jsx)(I.Bw,{children:s.map(e=>(0,a.jsxs)(I.Ql,{value:e.id,children:[e.title," ",!e.isActive&&"(Inactive)"]},e.id))})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(x._,{htmlFor:"message",children:"Announcement Message"}),(0,a.jsx)(F,{id:"message",placeholder:"Enter your announcement message...",value:j,onChange:e=>f(e.target.value),rows:4,className:"mt-1"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[j.length,"/500 characters"]})]}),j.trim()&&(0,a.jsxs)(Q.bZ,{children:[(0,a.jsx)(N.Z,{className:"h-4 w-4"}),(0,a.jsxs)(Q.X,{children:[(0,a.jsx)("strong",{children:"Preview:"})," \uD83D\uDCE2 ","QUIZ_SPECIFIC"===y&&b?'New announcement about "'.concat(null===(e=s.find(e=>e.id===b))||void 0===e?void 0:e.title,'": '):"General announcement: ",j]})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)(n.z,{onClick:C,disabled:!j.trim()||h||"QUIZ_SPECIFIC"===y&&!b,className:"bg-blue-600 hover:bg-blue-700",children:[(0,a.jsx)(V.Z,{className:"h-4 w-4 mr-2"}),h?"Sending...":"Send Announcement"]})})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsx)(c.ll,{children:"Quick Announcement Templates"}),(0,a.jsx)(c.SZ,{children:"Use these pre-made templates for common announcements"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsx)(n.z,{variant:"outline",onClick:()=>f("New quiz available! Check your dashboard to get started."),className:"h-auto p-4 text-left",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:"New Quiz Available"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Notify about new quiz"})]})}),(0,a.jsx)(n.z,{variant:"outline",onClick:()=>f("Quiz deadline reminder: Don't forget to complete your assigned quiz before the deadline."),className:"h-auto p-4 text-left",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:"Deadline Reminder"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Remind about deadlines"})]})}),(0,a.jsx)(n.z,{variant:"outline",onClick:()=>f("Study group sessions are now available! Join your classmates for collaborative learning."),className:"h-auto p-4 text-left",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:"Study Group Notice"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Promote study groups"})]})}),(0,a.jsx)(n.z,{variant:"outline",onClick:()=>f("Technical maintenance scheduled. The system may be temporarily unavailable."),className:"h-auto p-4 text-left",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:"Maintenance Notice"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"System maintenance"})]})}),(0,a.jsx)(n.z,{variant:"outline",onClick:()=>f("Great job on your recent quiz performance! Keep up the excellent work."),className:"h-auto p-4 text-left",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:"Encouragement"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Motivate students"})]})}),(0,a.jsx)(n.z,{variant:"outline",onClick:()=>f("Chat rooms are now available for quiz discussions. Join the conversation!"),className:"h-auto p-4 text-left",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:"Chat Available"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Promote discussions"})]})})]})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(R.Z,{className:"h-5 w-5"}),"Recent Announcements"]}),(0,a.jsx)(c.SZ,{children:"View previously sent announcements"})]}),(0,a.jsx)(c.aY,{children:o?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading announcements..."})]}):0===l.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(N.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Announcements Yet"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Send your first announcement to get started!"})]}):(0,a.jsx)("div",{className:"space-y-4",children:l.map(e=>(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[A(e.type),(0,a.jsx)(d.C,{className:k(e.type),children:e.type.replace("_"," ")}),e.quiz&&(0,a.jsx)(d.C,{variant:"outline",children:e.quiz.title})]}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleString()})]}),(0,a.jsx)("p",{className:"text-gray-900 mb-2",children:e.message}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,a.jsxs)("span",{children:["Sent by ",e.sender.name]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(p.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:"Broadcast to all students"})]})]})]},e.id))})})]})]})}function B(e){let{user:s,quizzes:t,stats:I}=e,q=(0,i.useRouter)(),[E,R]=(0,r.useState)(!1),[Q,P]=(0,r.useState)([]),[M,Y]=(0,r.useState)([]),[T,U]=(0,r.useState)(""),[D,G]=(0,r.useState)({name:"",description:"",quizId:"",memberIds:[]}),[F,V]=(0,r.useState)([]),[B,W]=(0,r.useState)(""),[J,X]=(0,r.useState)(!1),[K,$]=(0,r.useState)(""),[ee,es]=(0,r.useState)("dashboard"),[et,ea]=(0,r.useState)(t),[er,el]=(0,r.useState)([]),[ei,en]=(0,r.useState)([]),[ec,ed]=(0,r.useState)(!1),[eo,ex]=(0,r.useState)(!1),{socket:em,isConnected:eh}=(0,l.s)();(0,r.useEffect)(()=>{if(!em||!eh)return;let e=e=>{console.log("Admin: New quiz notification received:",e),eu()},s=e=>{console.log("Admin: Quiz update received:",e),eu()};return em.on("new-quiz-notification",e),em.on("quiz-broadcast",s),()=>{em.off("new-quiz-notification",e),em.off("quiz-broadcast",s)}},[em,eh]),(0,r.useEffect)(()=>{ep(),ef(),ej(),eg(),eu()},[]);let eu=async()=>{try{let e=await fetch("/api/quizzes");if(e.ok){let s=await e.json();ea(s)}}catch(e){console.error("Error fetching quizzes:",e)}},ej=async()=>{ed(!0);try{let e=await fetch("/api/users/students");if(e.ok){let s=await e.json();el(s)}}catch(e){console.error("Error fetching students:",e)}finally{ed(!1)}},eg=async()=>{ex(!0);try{let e=await fetch("/api/study-groups");if(e.ok){let s=await e.json();en(s)}}catch(e){console.error("Error fetching study groups:",e)}finally{ex(!1)}},ep=async()=>{try{let e=await fetch("/api/chat/rooms");if(e.ok){let s=await e.json();P(s)}}catch(e){console.error("Error fetching chat rooms:",e)}},ef=async()=>{try{let e=await fetch("/api/chat/monitor");if(e.ok){let s=await e.json();Y(s.activities||[])}}catch(e){console.error("Error fetching suspicious activities:",e),Y([])}},eN=async()=>{R(!0);try{await fetch("/api/auth/logout",{method:"POST"}),q.push("/")}catch(e){console.error("Logout error:",e)}finally{R(!1)}},eb=async e=>{if(confirm("Are you sure you want to delete this quiz? This action cannot be undone."))try{let s=await fetch("/api/quizzes/".concat(e),{method:"DELETE"});if(s.ok)ea(s=>s.filter(s=>s.id!==e)),alert("Quiz deleted successfully!");else{let e=await s.json();alert("Failed to delete quiz: ".concat(e.error||"Unknown error"))}}catch(e){console.error("Delete error:",e),alert("Failed to delete quiz")}},ev=async()=>{if(D.name.trim())try{let e=await fetch("/api/study-groups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)});if(e.ok)G({name:"",description:"",quizId:"",memberIds:[]}),ep(),eg(),alert("Study group created successfully!");else{let s=await e.json();alert("Error: ".concat(s.error))}}catch(e){console.error("Error creating study group:",e),alert("Failed to create study group")}},ey=async e=>{if(confirm("Are you sure you want to delete this study group? This will also delete all associated chat rooms and messages. This action cannot be undone."))try{let s=await fetch("/api/study-groups/".concat(e),{method:"DELETE"});if(s.ok)eg(),alert("Study group deleted successfully!");else{let e=await s.json();alert("Error: ".concat(e.error))}}catch(e){console.error("Error deleting study group:",e),alert("Failed to delete study group")}},ew=async(e,s)=>{try{let t=await fetch("/api/study-groups/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(t.ok)eg(),alert("Study group updated successfully!");else{let e=await t.json();alert("Error: ".concat(e.error))}}catch(e){console.error("Error updating study group:",e),alert("Failed to update study group")}},ez=e=>{G(s=>({...s,memberIds:s.memberIds.includes(e)?s.memberIds.filter(s=>s!==e):[...s.memberIds,e]}))},eS=async()=>{if(K.trim()&&T)try{(await fetch("/api/announcements",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({quizId:T,message:K,type:T?"QUIZ_SPECIFIC":"GENERAL"})})).ok&&($(""),alert("Announcement sent successfully!"))}catch(e){console.error("Error sending announcement:",e)}},eZ=async(e,s)=>{try{(await fetch("/api/quizzes/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({enableChat:s})})).ok&&ea(t=>t.map(t=>t.id===e?{...t,enableChat:s}:t))}catch(e){console.error("Error updating quiz chat settings:",e)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[(0,a.jsx)("header",{className:"bg-white/80 backdrop-blur-sm shadow-lg border-b border-blue-100 sticky top-0 z-50",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 p-2 rounded-lg mr-3",children:(0,a.jsx)(h.Z,{className:"h-6 w-6 text-white"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-700 to-indigo-700 bg-clip-text text-transparent",children:"Admin Dashboard"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 bg-blue-50 px-3 py-2 rounded-lg",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-blue-700",children:["Welcome, ",s.name]})]}),(0,a.jsxs)(n.z,{onClick:eN,variant:"outline",size:"sm",disabled:E,className:"flex items-center gap-2 border-blue-200 text-blue-700 hover:bg-blue-50 hover:border-blue-300",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4"}),E?"Logging out...":"Logout"]})]})]})})}),(0,a.jsxs)("div",{className:"flex h-[calc(100vh-80px)]",children:[(0,a.jsx)("div",{className:"w-64 bg-white/70 backdrop-blur-sm border-r border-blue-100 p-6",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(n.z,{onClick:()=>es("dashboard"),variant:"dashboard"===ee?"default":"ghost",className:"w-full justify-start ".concat("dashboard"===ee?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg":"text-blue-700 hover:bg-blue-50 hover:text-blue-800"),children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Dashboard"]}),(0,a.jsxs)(n.z,{onClick:()=>es("quizzes"),variant:"quizzes"===ee?"default":"ghost",className:"w-full justify-start ".concat("quizzes"===ee?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg":"text-blue-700 hover:bg-blue-50 hover:text-blue-800"),children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Quizzes"]}),(0,a.jsxs)(n.z,{onClick:()=>es("students"),variant:"students"===ee?"default":"ghost",className:"w-full justify-start ".concat("students"===ee?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg":"text-blue-700 hover:bg-blue-50 hover:text-blue-800"),children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"Students"]}),(0,a.jsxs)(n.z,{onClick:()=>es("chat"),variant:"chat"===ee?"default":"ghost",className:"w-full justify-start ".concat("chat"===ee?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg":"text-blue-700 hover:bg-blue-50 hover:text-blue-800"),children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Chat Participation"]}),(0,a.jsxs)(n.z,{onClick:()=>es("groups"),variant:"groups"===ee?"default":"ghost",className:"w-full justify-start ".concat("groups"===ee?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg":"text-blue-700 hover:bg-blue-50 hover:text-blue-800"),children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"Study Groups"]}),(0,a.jsxs)(n.z,{onClick:()=>es("announcements"),variant:"announcements"===ee?"default":"ghost",className:"w-full justify-start ".concat("announcements"===ee?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg":"text-blue-700 hover:bg-blue-50 hover:text-blue-800"),children:[(0,a.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"Announcements"]}),(0,a.jsxs)(n.z,{onClick:()=>es("monitoring"),variant:"monitoring"===ee?"default":"ghost",className:"w-full justify-start ".concat("monitoring"===ee?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg":"text-blue-700 hover:bg-blue-50 hover:text-blue-800"),children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Monitoring"]}),(0,a.jsxs)(n.z,{onClick:()=>es("analytics"),variant:"analytics"===ee?"default":"ghost",className:"w-full justify-start ".concat("analytics"===ee?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg":"text-blue-700 hover:bg-blue-50 hover:text-blue-800"),children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Learning Analytics"]}),(0,a.jsxs)(n.z,{onClick:()=>es("predictive"),variant:"predictive"===ee?"default":"ghost",className:"w-full justify-start ".concat("predictive"===ee?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg":"text-blue-700 hover:bg-blue-50 hover:text-blue-800"),children:[(0,a.jsx)(b.Z,{className:"h-4 w-4 mr-2"}),"Predictive Analytics"]}),(0,a.jsxs)(n.z,{onClick:()=>es("integrity"),variant:"integrity"===ee?"default":"ghost",className:"w-full justify-start ".concat("integrity"===ee?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg":"text-blue-700 hover:bg-blue-50 hover:text-blue-800"),children:[(0,a.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"Integrity Report"]})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-auto",children:(0,a.jsxs)(m.mQ,{value:ee,onValueChange:es,className:"h-full",children:[(0,a.jsx)(m.nU,{value:"dashboard",className:"space-y-6 p-6",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-blue-700 to-indigo-700 bg-clip-text text-transparent",children:"Dashboard Overview"}),(0,a.jsx)("p",{className:"text-blue-600 mt-2",children:"Manage your quiz system and monitor student activity"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsxs)(c.Zb,{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200 shadow-lg hover:shadow-xl transition-all duration-300",children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium text-blue-700",children:"Total Quizzes"}),(0,a.jsx)("div",{className:"bg-blue-100 p-2 rounded-lg",children:(0,a.jsx)(g.Z,{className:"h-4 w-4 text-blue-600"})})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-800",children:I.totalQuizzes}),(0,a.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"+2 from last month"})]})]}),(0,a.jsxs)(c.Zb,{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border-emerald-200 shadow-lg hover:shadow-xl transition-all duration-300",children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium text-emerald-700",children:"Total Attempts"}),(0,a.jsx)("div",{className:"bg-emerald-100 p-2 rounded-lg",children:(0,a.jsx)(y.Z,{className:"h-4 w-4 text-emerald-600"})})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-emerald-800",children:I.totalAttempts}),(0,a.jsx)("p",{className:"text-xs text-emerald-600 mt-1",children:"+12% from last week"})]})]}),(0,a.jsxs)(c.Zb,{className:"bg-gradient-to-br from-purple-50 to-violet-50 border-purple-200 shadow-lg hover:shadow-xl transition-all duration-300",children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium text-purple-700",children:"Average Score"}),(0,a.jsx)("div",{className:"bg-purple-100 p-2 rounded-lg",children:(0,a.jsx)(j.Z,{className:"h-4 w-4 text-purple-600"})})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-purple-800",children:[I.averageScore,"%"]}),(0,a.jsx)("p",{className:"text-xs text-purple-600 mt-1",children:"+5% from last month"})]})]}),(0,a.jsxs)(c.Zb,{className:"bg-gradient-to-br from-orange-50 to-amber-50 border-orange-200 shadow-lg hover:shadow-xl transition-all duration-300",children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium text-orange-700",children:"Chat Rooms"}),(0,a.jsx)("div",{className:"bg-orange-100 p-2 rounded-lg",children:(0,a.jsx)(f.Z,{className:"h-4 w-4 text-orange-600"})})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-800",children:I.totalChatRooms}),(0,a.jsx)("p",{className:"text-xs text-orange-600 mt-1",children:"Active discussions"})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium",children:"Study Groups"}),(0,a.jsx)(p.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:I.activeStudyGroups})})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsx)(c.ll,{children:"Recent Activity"}),(0,a.jsx)(c.SZ,{children:"Latest quiz attempts and system activities"})]}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Recent activity data would be displayed here..."})})})]})]})}),(0,a.jsx)(m.nU,{value:"quizzes",className:"space-y-6 p-6",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Quiz Management"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Create, edit, and manage quizzes with integrated chat settings"})]}),(0,a.jsxs)(n.z,{onClick:()=>q.push("/admin/quizzes/create"),className:"btn-primary-professional",children:[(0,a.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Create New Quiz"]})]}),(0,a.jsx)("div",{className:"grid gap-6",children:et.map(e=>(0,a.jsxs)(c.Zb,{className:"card-professional card-professional-hover",children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-3 text-lg",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(g.Z,{className:"h-4 w-4 text-white"})}),e.title,!e.isActive&&(0,a.jsx)(d.C,{variant:"secondary",children:"Inactive"})]}),(0,a.jsx)(c.SZ,{className:"mt-2",children:e.description||"No description provided"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>eZ(e.id,!e.enableChat),className:"btn-secondary-professional",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),e.enableChat?"Disable Chat":"Enable Chat"]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>q.push("/admin/quizzes/".concat(e.id,"/results")),className:"btn-secondary-professional",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Results"]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>q.push("/admin/quizzes/".concat(e.id,"/edit")),className:"btn-secondary-professional",children:[(0,a.jsx)(z.Z,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>eb(e.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[(0,a.jsxs)("span",{children:[e._count.questions," questions"]}),(0,a.jsxs)("span",{children:[e._count.attempts," attempts"]}),(0,a.jsxs)("span",{children:["Passing: ",e.passingScore,"%"]})]})})]},e.id))})]})}),(0,a.jsx)(m.nU,{value:"students",className:"space-y-6 p-6",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex justify-between items-center",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-blue-700 to-indigo-700 bg-clip-text text-transparent",children:"Student Management"}),(0,a.jsx)("p",{className:"text-blue-600 mt-2",children:"Monitor student performance and manage accounts"})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)(c.Zb,{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200 shadow-lg",children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium text-blue-700",children:"Total Students"}),(0,a.jsx)("div",{className:"bg-blue-100 p-2 rounded-lg",children:(0,a.jsx)(p.Z,{className:"h-4 w-4 text-blue-600"})})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-800",children:er.length}),(0,a.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"Active accounts"})]})]}),(0,a.jsxs)(c.Zb,{className:"bg-gradient-to-br from-emerald-50 to-teal-50 border-emerald-200 shadow-lg",children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium text-emerald-700",children:"Active This Week"}),(0,a.jsx)("div",{className:"bg-emerald-100 p-2 rounded-lg",children:(0,a.jsx)(y.Z,{className:"h-4 w-4 text-emerald-600"})})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-emerald-800",children:Math.floor(.8*er.length)}),(0,a.jsx)("p",{className:"text-xs text-emerald-600 mt-1",children:"80% engagement"})]})]}),(0,a.jsxs)(c.Zb,{className:"bg-gradient-to-br from-purple-50 to-violet-50 border-purple-200 shadow-lg",children:[(0,a.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(c.ll,{className:"text-sm font-medium text-purple-700",children:"Avg Performance"}),(0,a.jsx)("div",{className:"bg-purple-100 p-2 rounded-lg",children:(0,a.jsx)(j.Z,{className:"h-4 w-4 text-purple-600"})})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-purple-800",children:[I.averageScore,"%"]}),(0,a.jsx)("p",{className:"text-xs text-purple-600 mt-1",children:"Class average"})]})]})]}),(0,a.jsxs)(c.Zb,{className:"shadow-lg border-blue-100",children:[(0,a.jsxs)(c.Ol,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-blue-100",children:[(0,a.jsx)(c.ll,{className:"text-blue-800",children:"Student Directory"}),(0,a.jsx)(c.SZ,{className:"text-blue-600",children:"View and manage all student accounts"})]}),(0,a.jsx)(c.aY,{className:"p-0",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 border-b",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quiz Attempts"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Score"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Active"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:er.map(e=>{let s=e.quizAttempts||[],t=s.length>0?Math.round(s.reduce((e,s)=>e+s.score,0)/s.length):0;return(0,a.jsxs)("tr",{className:"hover:bg-blue-50 transition-colors",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-gradient-to-r from-blue-400 to-indigo-500 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm font-medium text-white",children:e.name.charAt(0).toUpperCase()})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.id.slice(0,8)]})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:e.email})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:s.length})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-900",children:[t,"%"]}),(0,a.jsx)("div",{className:"ml-2 w-16 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full ".concat(t>=80?"bg-green-500":t>=60?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(Math.min(t,100),"%")}})})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)(d.C,{variant:t>=60?"default":"destructive",className:t>=60?"bg-green-100 text-green-800":"",children:t>=60?"Good Standing":"Needs Support"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(n.z,{variant:"outline",size:"sm",className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:"View Details"}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",className:"text-gray-600 border-gray-200 hover:bg-gray-50",children:"Message"})]})})]},e.id)})})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(c.Zb,{className:"shadow-lg border-blue-100",children:[(0,a.jsxs)(c.Ol,{className:"bg-gradient-to-r from-emerald-50 to-teal-50 border-b border-emerald-100",children:[(0,a.jsx)(c.ll,{className:"text-emerald-800",children:"Top Performers"}),(0,a.jsx)(c.SZ,{className:"text-emerald-600",children:"Students with highest average scores"})]}),(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsx)("div",{className:"space-y-3",children:er.filter(e=>e.quizAttempts&&e.quizAttempts.length>0).sort((e,s)=>{let t=e.quizAttempts.reduce((e,s)=>e+s.score,0)/e.quizAttempts.length;return s.quizAttempts.reduce((e,s)=>e+s.score,0)/s.quizAttempts.length-t}).slice(0,5).map((e,s)=>{let t=Math.round(e.quizAttempts.reduce((e,s)=>e+s.score,0)/e.quizAttempts.length);return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-emerald-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsxs)(d.C,{variant:"outline",className:"bg-emerald-100 text-emerald-800",children:["#",s+1]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[e.quizAttempts.length," attempts"]})]})]}),(0,a.jsxs)("div",{className:"text-lg font-bold text-emerald-600",children:[t,"%"]})]},e.id)})})})]}),(0,a.jsxs)(c.Zb,{className:"shadow-lg border-blue-100",children:[(0,a.jsxs)(c.Ol,{className:"bg-gradient-to-r from-orange-50 to-red-50 border-b border-orange-100",children:[(0,a.jsx)(c.ll,{className:"text-orange-800",children:"Students Needing Support"}),(0,a.jsx)(c.SZ,{className:"text-orange-600",children:"Students who may need additional help"})]}),(0,a.jsx)(c.aY,{className:"p-4",children:(0,a.jsx)("div",{className:"space-y-3",children:er.filter(e=>!e.quizAttempts||0===e.quizAttempts.length||e.quizAttempts.reduce((e,s)=>e+s.score,0)/e.quizAttempts.length<60).slice(0,5).map(e=>{let s=e.quizAttempts&&e.quizAttempts.length>0?Math.round(e.quizAttempts.reduce((e,s)=>e+s.score,0)/e.quizAttempts.length):0;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(Z.Z,{className:"h-4 w-4 text-orange-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[e.quizAttempts?e.quizAttempts.length:0," attempts"]})]})]}),(0,a.jsxs)("div",{className:"text-lg font-bold text-orange-600",children:[s,"%"]})]},e.id)})})})]})]})]})}),(0,a.jsx)(m.nU,{value:"chat",className:"space-y-6 p-6",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Chat Participation"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Join quiz discussions and monitor chat activity"}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,a.jsx)("strong",{children:"Note:"})," Chat rooms are automatically created when quizzes with chat are published. No manual creation needed."]})})]}),0===Q.length?(0,a.jsx)(c.Zb,{children:(0,a.jsxs)(c.aY,{className:"text-center py-16",children:[(0,a.jsx)(f.Z,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No chat rooms available"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Chat rooms will appear here when quizzes with chat are created"})]})}):(0,a.jsx)("div",{className:"grid gap-6",children:Q.map(e=>{var s;return(0,a.jsx)(c.Zb,{className:"hover:shadow-lg transition-shadow",children:(0,a.jsx)(c.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(f.Z,{className:"h-5 w-5 text-blue-600"}),(0,a.jsx)(c.ll,{children:e.name}),(0,a.jsx)(d.C,{variant:"outline",className:"QUIZ_DISCUSSION"===e.type?"border-blue-200 text-blue-700":"STUDY_GROUP"===e.type?"border-purple-200 text-purple-700":"border-green-200 text-green-700",children:"QUIZ_DISCUSSION"===e.type?"Quiz Discussion":"STUDY_GROUP"===e.type?"Study Group":"General"})]}),(0,a.jsxs)(c.SZ,{className:"mt-2",children:[null===(s=e._count)||void 0===s?void 0:s.messages," messages",e.quiz&&" • Quiz: ".concat(e.quiz.title)]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[e.isActive&&(0,a.jsxs)(n.z,{variant:"default",size:"sm",onClick:()=>window.open("/chat/".concat(e.id),"_blank"),className:"bg-blue-600 hover:bg-blue-700",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Join Chat"]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>q.push("/admin/chat/moderation?room=".concat(e.id)),children:[(0,a.jsx)(C.Z,{className:"h-4 w-4 mr-2"}),"Monitor"]})]})]})})},e.id)})})]})}),(0,a.jsx)(m.nU,{value:"groups",className:"space-y-6 p-6",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Study Groups"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Create and manage collaborative learning groups with quiz association"})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsx)(c.ll,{children:"Create New Study Group"}),(0,a.jsx)(c.SZ,{children:"Create a study group for a specific quiz and select students to participate"})]}),(0,a.jsxs)(c.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(x._,{htmlFor:"groupName",children:"Group Name *"}),(0,a.jsx)(o.I,{id:"groupName",value:D.name,onChange:e=>G({...D,name:e.target.value}),placeholder:"Enter group name",className:"input-professional"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(x._,{htmlFor:"quizSelect",children:"Associated Quiz"}),(0,a.jsxs)("select",{id:"quizSelect",value:D.quizId,onChange:e=>G({...D,quizId:e.target.value}),className:"w-full p-2 border rounded-md input-professional",children:[(0,a.jsx)("option",{value:"",children:"Select a quiz (optional)..."}),t.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title},e.id))]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(x._,{htmlFor:"groupDescription",children:"Description"}),(0,a.jsx)(o.I,{id:"groupDescription",value:D.description,onChange:e=>G({...D,description:e.target.value}),placeholder:"Enter group description (optional)",className:"input-professional"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(x._,{children:"Select Students"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Choose students to add to this study group"}),ec?(0,a.jsxs)("div",{className:"flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-2",children:"Loading students..."})]}):(0,a.jsx)("div",{className:"max-h-64 overflow-y-auto border rounded-lg p-3 space-y-2",children:0===er.length?(0,a.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No students found"}):er.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-3 p-2 hover:bg-gray-50 rounded",children:[(0,a.jsx)("input",{type:"checkbox",id:"student-".concat(e.id),checked:D.memberIds.includes(e.id),onChange:()=>ez(e.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"student-".concat(e.id),className:"flex-1 cursor-pointer",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:[e._count.attempts," quiz attempts"]})]})})]},e.id))}),D.memberIds.length>0&&(0,a.jsxs)("p",{className:"text-sm text-blue-600 mt-2",children:[D.memberIds.length," student",1!==D.memberIds.length?"s":""," selected"]})]}),(0,a.jsxs)(n.z,{onClick:ev,disabled:!D.name.trim(),className:"btn-primary-professional",children:[(0,a.jsx)(k.Z,{className:"h-4 w-4 mr-2"}),"Create Study Group"]})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsx)(c.ll,{children:"Existing Study Groups"}),(0,a.jsx)(c.SZ,{children:"Manage and view all study groups"})]}),(0,a.jsx)(c.aY,{children:eo?(0,a.jsxs)("div",{className:"flex items-center justify-center p-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-3",children:"Loading study groups..."})]}):0===ei.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(p.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No study groups created yet"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Create your first study group above"})]}):(0,a.jsx)("div",{className:"space-y-4",children:ei.map(e=>(0,a.jsxs)(c.Zb,{className:"border-l-4 border-l-green-500",children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-green-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(p.Z,{className:"h-4 w-4 text-white"})}),e.name]}),(0,a.jsx)(c.SZ,{className:"mt-2",children:e.description||"No description provided"}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-600",children:[(0,a.jsxs)("span",{children:["Created by: ",e.creator.name]}),(0,a.jsx)("span",{children:"•"}),(0,a.jsxs)("span",{children:[e._count.members," member",1!==e._count.members?"s":""]}),e.quiz&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"•"}),(0,a.jsxs)("span",{children:["Quiz: ",e.quiz.title]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>{var s,t;return q.push("/chat?room=".concat(null===(t=e.chatRooms)||void 0===t?void 0:null===(s=t[0])||void 0===s?void 0:s.id))},className:"btn-secondary-professional",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"View Chat"]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>{let s=prompt("Enter new group name:",e.name);s&&s!==e.name&&ew(e.id,{name:s})},className:"border-blue-200 text-blue-700 hover:bg-blue-50",children:[(0,a.jsx)(z.Z,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>ey(e.id),className:"border-red-200 text-red-700 hover:bg-red-50",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)(x._,{className:"text-sm font-medium text-gray-700",children:"Members:"}),(0,a.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:0===e.members.length?(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"No members yet"}):e.members.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-gray-100 rounded-full px-3 py-1 text-sm",children:[(0,a.jsx)("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs",children:e.user.name.charAt(0).toUpperCase()}),(0,a.jsx)("span",{children:e.user.name}),"moderator"===e.role&&(0,a.jsx)(d.C,{variant:"secondary",className:"text-xs",children:"Moderator"})]},e.user.id))})]})})]},e.id))})})]})]})}),(0,a.jsx)(m.nU,{value:"integrity",className:"space-y-6 p-6",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Academic Integrity"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Monitor suspicious activities and maintain academic standards"})]}),(0,a.jsx)("div",{className:"grid gap-6",children:M.map(e=>(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsx)("div",{className:"flex justify-between items-start",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4"}),"Suspicious Activity",(0,a.jsx)(d.C,{variant:"HIGH"===e.severity?"destructive":"MEDIUM"===e.severity?"default":"secondary",children:e.severity})]}),(0,a.jsxs)(c.SZ,{children:["User: ",e.user.name," • Room: ",e.room.name]})]})})}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("p",{className:"text-sm",children:e.activity})})]},e.id))})]})}),(0,a.jsx)(m.nU,{value:"announcements",className:"space-y-6 p-6",children:(0,a.jsx)(H,{})}),(0,a.jsx)(m.nU,{value:"analytics",className:"space-y-6 p-6",children:(0,a.jsx)(O,{})}),(0,a.jsx)(m.nU,{value:"predictive",className:"space-y-6 p-6",children:(0,a.jsx)(L,{})}),(0,a.jsx)(m.nU,{value:"integrity",className:"space-y-6 p-6",children:(0,a.jsx)(_,{})}),(0,a.jsx)(m.nU,{value:"legacy-announcements",className:"space-y-6 p-6",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Announcements"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Send announcements to quiz discussion rooms"})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsx)(c.ll,{children:"Send Announcement"})}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(x._,{htmlFor:"quizSelect",children:"Select Quiz"}),(0,a.jsxs)("select",{id:"quizSelect",value:T,onChange:e=>U(e.target.value),className:"w-full p-2 border rounded-md",children:[(0,a.jsx)("option",{value:"",children:"Select a quiz..."}),t.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(x._,{htmlFor:"announcement",children:"Announcement Message"}),(0,a.jsx)(o.I,{id:"announcement",value:K,onChange:e=>$(e.target.value),placeholder:"Enter your announcement..."})]}),(0,a.jsxs)(n.z,{onClick:eS,disabled:!T||!K.trim(),className:"btn-primary-professional",children:[(0,a.jsx)(A.Z,{className:"h-4 w-4 mr-2"}),"Send Announcement"]})]})]})]})})]})})]})]})}},5937:function(e,s,t){"use strict";t.d(s,{X:function(){return d},bZ:function(){return c}});var a=t(7437),r=t(2265),l=t(535),i=t(3448);let n=(0,l.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=r.forwardRef((e,s)=>{let{className:t,variant:r,...l}=e;return(0,a.jsx)("div",{ref:s,role:"alert",className:(0,i.cn)(n({variant:r}),t),...l})});c.displayName="Alert",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h5",{ref:s,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",t),...r})}).displayName="AlertTitle";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",t),...r})});d.displayName="AlertDescription"},9174:function(e,s,t){"use strict";t.d(s,{C:function(){return n}});var a=t(7437);t(2265);var r=t(535),l=t(3448);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,l.cn)(i({variant:t}),s),...r})}},2381:function(e,s,t){"use strict";t.d(s,{z:function(){return d}});var a=t(7437),r=t(2265),l=t(7053),i=t(535),n=t(3448);let c=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,s)=>{let{className:t,variant:r,size:i,asChild:d=!1,...o}=e,x=d?l.g7:"button";return(0,a.jsx)(x,{className:(0,n.cn)(c({variant:r,size:i,className:t})),ref:s,...o})});d.displayName="Button"},9820:function(e,s,t){"use strict";t.d(s,{Ol:function(){return n},SZ:function(){return d},Zb:function(){return i},aY:function(){return o},ll:function(){return c}});var a=t(7437),r=t(2265),l=t(3448);let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});i.displayName="Card";let n=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...r})});n.displayName="CardHeader";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});c.displayName="CardTitle";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",t),...r})});d.displayName="CardDescription";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",t),...r})});o.displayName="CardContent",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter"},279:function(e,s,t){"use strict";t.d(s,{I:function(){return i}});var a=t(7437),r=t(2265),l=t(3448);let i=r.forwardRef((e,s)=>{let{className:t,type:r,...i}=e;return(0,a.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...i})});i.displayName="Input"},5060:function(e,s,t){"use strict";t.d(s,{_:function(){return d}});var a=t(7437),r=t(2265),l=t(6394),i=t(535),n=t(3448);let c=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.f,{ref:s,className:(0,n.cn)(c(),t),...r})});d.displayName=l.f.displayName},5291:function(e,s,t){"use strict";t.d(s,{Bw:function(){return j},Ph:function(){return o},Ql:function(){return g},i4:function(){return m},ki:function(){return x}});var a=t(7437),r=t(2265),l=t(8856),i=t(875),n=t(2135),c=t(401),d=t(3448);let o=l.fC;l.ZA;let x=l.B4,m=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(l.xz,{ref:s,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[r,(0,a.jsx)(l.JO,{asChild:!0,children:(0,a.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=l.xz.displayName;let h=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.u_,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(n.Z,{className:"h-4 w-4"})})});h.displayName=l.u_.displayName;let u=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.$G,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})});u.displayName=l.$G.displayName;let j=r.forwardRef((e,s)=>{let{className:t,children:r,position:i="popper",...n}=e;return(0,a.jsx)(l.h_,{children:(0,a.jsxs)(l.VY,{ref:s,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i,...n,children:[(0,a.jsx)(h,{}),(0,a.jsx)(l.l_,{className:(0,d.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(u,{})]})})});j.displayName=l.VY.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.__,{ref:s,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=l.__.displayName;let g=r.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsxs)(l.ck,{ref:s,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(l.wU,{children:(0,a.jsx)(c.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(l.eT,{children:r})]})});g.displayName=l.ck.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.Z0,{ref:s,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=l.Z0.displayName},7168:function(e,s,t){"use strict";t.d(s,{SP:function(){return d},dr:function(){return c},mQ:function(){return n},nU:function(){return o}});var a=t(7437),r=t(2265),l=t(271),i=t(3448);let n=l.fC,c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.aV,{ref:s,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...r})});c.displayName=l.aV.displayName;let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.xz,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...r})});d.displayName=l.xz.displayName;let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.VY,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r})});o.displayName=l.VY.displayName},3795:function(e,s,t){"use strict";t.d(s,{s:function(){return c}});var a=t(2265),r=t(8680),l=t(257);let i=null,n=0;function c(e){let[s,t]=(0,a.useState)(null),[c,d]=(0,a.useState)(!1),[o,x]=(0,a.useState)([]),m=(0,a.useRef)(),h=(0,a.useRef)(0),u=(0,a.useCallback)(()=>{if(i&&i.connected){t(i),d(!0);return}if(i&&!i.connected&&!1===i.disconnected){t(i);return}i||(console.log("Creating new WebSocket connection"),(i=(0,r.io)(l.env.NEXT_PUBLIC_SOCKET_URL||window.location.origin,{path:"/api/socketio",transports:["websocket","polling"],upgrade:!0,rememberUpgrade:!0,timeout:2e4,forceNew:!1,reconnection:!1})).on("connect",()=>{console.log("Connected to server"),h.current=0,d(!0),m.current&&clearTimeout(m.current)}),i.on("disconnect",e=>{if(console.log("Disconnected from server:",e),d(!1),("io server disconnect"===e||"transport close"===e)&&h.current<5){let e=1e3*Math.pow(2,h.current);m.current=setTimeout(()=>{console.log("Attempting to reconnect... (".concat(h.current+1,"/").concat(5,")")),h.current++,i&&i.connect()},e)}else h.current>=5&&console.log("Max reconnection attempts reached. Stopping reconnection.")}),i.on("connect_error",e=>{console.error("Connection error:",e),d(!1)})),t(i)},[]);(0,a.useEffect)(()=>(n++,u(),()=>{n--,m.current&&clearTimeout(m.current),0===n&&i&&(console.log("Closing global WebSocket connection"),i.close(),i=null)}),[]);let j=(0,a.useCallback)((e,t)=>{s&&s.on(e,t)},[s]),g=(0,a.useCallback)((e,t)=>{s&&(t?s.off(e,t):s.off(e))},[s]),p=(0,a.useCallback)((t,a)=>{s&&c&&s.emit("join-study-session",{sessionId:t,userId:a||(null==e?void 0:e.userId)})},[s,c,null==e?void 0:e.userId]),f=(0,a.useCallback)((t,a)=>{s&&c&&s.emit("leave-study-session",{sessionId:t,userId:a||(null==e?void 0:e.userId)})},[s,c,null==e?void 0:e.userId]),N=(0,a.useCallback)((t,a,r,l)=>{s&&c&&s.emit("study-session-update",{sessionId:t,updateType:a,content:r,userId:l||(null==e?void 0:e.userId)})},[s,c,null==e?void 0:e.userId]);return{socket:s,isConnected:c,connect:u,on:j,off:g,joinStudySession:p,leaveStudySession:f,sendStudySessionUpdate:N,recentAnnouncements:o}}},3448:function(e,s,t){"use strict";t.d(s,{cn:function(){return l}});var a=t(1994),r=t(3335);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.m6)((0,a.W)(s))}}},function(e){e.O(0,[284,265,705,829,807,741,971,117,744],function(){return e(e.s=8552)}),_N_E=e.O()}]);