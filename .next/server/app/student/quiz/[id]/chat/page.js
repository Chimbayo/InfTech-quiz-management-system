(()=>{var e={};e.id=708,e.ids=[708],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16534:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>o,originalPathname:()=>x,pages:()=>m,routeModule:()=>h,tree:()=>d}),t(46582),t(32029),t(35866);var a=t(23191),i=t(88716),l=t(37922),n=t.n(l),r=t(95231),c={};for(let e in r)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>r[e]);t.d(s,c);let d=["",{children:["student",{children:["quiz",{children:["[id]",{children:["chat",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,46582)),"C:\\Users\\HP\\Documents\\InfTech-quiz-management-system\\src\\app\\student\\quiz\\[id]\\chat\\page.tsx"]}]},{}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,32029)),"C:\\Users\\HP\\Documents\\InfTech-quiz-management-system\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],m=["C:\\Users\\HP\\Documents\\InfTech-quiz-management-system\\src\\app\\student\\quiz\\[id]\\chat\\page.tsx"],x="/student/quiz/[id]/chat/page",o={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/student/quiz/[id]/chat/page",pathname:"/student/quiz/[id]/chat",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},47606:(e,s,t)=>{Promise.resolve().then(t.bind(t,97343))},97343:(e,s,t)=>{"use strict";t.d(s,{QuizInterfaceWithChat:()=>y});var a=t(10326),i=t(17577),l=t(35047),n=t(91664),r=t(29752),c=t(3282),d=t(9280),m=t(44794),x=t(33261),o=t(38443),h=t(86333),u=t(40617),j=t(54659),p=t(94019),g=t(48998),N=t(37202),f=t(75290),b=t(24230),v=t(25023);function y({quiz:e,userId:s,chatRooms:t=[]}){let y=(0,l.useRouter)(),[w,z]=(0,i.useState)(0),[q,C]=(0,i.useState)([]),[I,S]=(0,i.useState)(null),[P,Z]=(0,i.useState)(!1),[_,k]=(0,i.useState)(""),[A]=(0,i.useState)(Date.now()),[O,E]=(0,i.useState)(!1),[T,D]=(0,i.useState)(null),[M,Q]=(0,i.useState)(!1),[$,L]=(0,i.useState)(!1),R=e.questions[w],H=w===e.questions.length-1,U=0===w,F=M&&!$,Y=(e,s)=>{C(t=>{let a=[...t],i=a[w];return"MULTIPLE_CHOICE"===R.type?i.selectedOptionIds=s?[e]:[]:s?i.selectedOptionIds=[e]:i.selectedOptionIds=[],a})},G=async()=>{Z(!0),k("");try{let t=Math.floor((Date.now()-A)/1e3),a=await fetch("/api/quiz-attempts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({quizId:e.id,userId:s,answers:q,timeSpent:t})}),i=await a.json();if(!a.ok)throw Error(i.error||"Failed to submit quiz");L(!0),E(!0),setTimeout(()=>{y.push(`/student/quiz/${e.id}/results`)},2e3)}catch(e){k(e instanceof Error?e.message:"An error occurred")}finally{Z(!1)}},X=()=>q[w]?.selectedOptionIds||[],B=()=>q.every(e=>e.selectedOptionIds.length>0);return M?$?a.jsx("div",{className:"min-h-screen bg-gray-50",children:a.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:a.jsx(r.Zb,{children:(0,a.jsxs)(r.aY,{className:"text-center py-16",children:[a.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx(j.Z,{className:"h-10 w-10 text-green-600"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Quiz Completed!"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Your answers have been submitted successfully. You'll be redirected to see your results shortly."}),e.enableChat&&a.jsx("p",{className:"text-sm text-green-600 mb-4",children:"Chat is now available for post-quiz discussions."}),a.jsx(n.z,{onClick:()=>y.push(`/student/quiz/${e.id}/results`),className:"btn-primary-professional",children:"View Results"})]})})})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white shadow-sm border-b",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:e.title}),F&&e.enableChat&&(0,a.jsxs)(o.C,{variant:"secondary",className:"ml-4",children:[a.jsx(u.Z,{className:"h-3 w-3 mr-1"}),"Chat Disabled During Quiz"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[null!==I&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(g.Z,{className:"h-4 w-4"}),a.jsx("span",{className:I<300?"text-red-600 font-medium":"",children:`${Math.floor(I/60)}:${(I%60).toString().padStart(2,"0")}`})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[q.filter(e=>e.selectedOptionIds.length>0).length,"/",e.questions.length," answered",B()&&a.jsx("span",{className:"ml-2 text-green-600 font-medium",children:"âœ“ All answered"})]})]})]})})}),(0,a.jsxs)("div",{className:`flex ${O?"h-screen":""}`,children:[a.jsx("div",{className:`${O?"flex-1":"w-full"} overflow-auto`,children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_&&(0,a.jsxs)(x.bZ,{variant:"destructive",className:"mb-6",children:[a.jsx(N.Z,{className:"h-4 w-4"}),a.jsx(x.X,{children:_})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,a.jsxs)("span",{children:["Question ",w+1," of ",e.questions.length]}),(0,a.jsxs)("span",{children:[Math.round((w+1)/e.questions.length*100),"% Complete"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${(w+1)/e.questions.length*100}%`}})})]}),(0,a.jsxs)(r.Zb,{className:"mb-8",children:[a.jsx(r.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx(r.ll,{className:"text-lg",children:R.text}),a.jsx(r.SZ,{children:"MULTIPLE_CHOICE"===R.type?"Select the correct answer":"Select True or False"})]}),X().length>0&&a.jsx("div",{className:"ml-4 flex-shrink-0",children:a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:a.jsx(j.Z,{className:"h-5 w-5 text-green-600"})})})]})}),a.jsx(r.aY,{children:"MULTIPLE_CHOICE"===R.type?a.jsx(c.E,{value:X()[0]||"",onValueChange:e=>Y(e,!0),children:R.options.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(c.m,{value:e.id,id:e.id}),a.jsx(m._,{htmlFor:e.id,className:"flex-1 cursor-pointer",children:e.text})]},e.id))}):a.jsx("div",{className:"space-y-3",children:R.options.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(d.X,{id:e.id,checked:X().includes(e.id),onCheckedChange:s=>Y(e.id,!!s)}),a.jsx(m._,{htmlFor:e.id,className:"flex-1 cursor-pointer",children:e.text})]},e.id))})})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(n.z,{variant:"outline",onClick:()=>{U||z(e=>e-1)},disabled:U,children:[a.jsx(h.Z,{className:"h-4 w-4 mr-2"}),"Previous"]}),(0,a.jsxs)("div",{className:"flex flex-col items-end space-y-2",children:[H&&!B()&&(0,a.jsxs)("div",{className:"text-sm text-amber-600 bg-amber-50 px-3 py-2 rounded-lg border border-amber-200",children:[a.jsx(N.Z,{className:"h-4 w-4 inline mr-2"}),"Please answer all ",e.questions.length," questions before submitting (",q.filter(e=>e.selectedOptionIds.length>0).length,"/",e.questions.length," answered)"]}),a.jsx("div",{className:"flex space-x-4",children:H?(0,a.jsxs)(n.z,{onClick:G,disabled:P||!B(),children:[P&&a.jsx(f.Z,{className:"mr-2 h-4 w-4 animate-spin"}),a.jsx(j.Z,{className:"mr-2 h-4 w-4"}),"Submit Quiz"]}):(0,a.jsxs)(n.z,{onClick:()=>{H||z(e=>e+1)},children:["Next",a.jsx(b.Z,{className:"h-4 w-4 ml-2"})]})})]})]})]})}),O&&e.enableChat&&!F&&T&&a.jsx("div",{className:"w-96 border-l bg-white",children:(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[a.jsx("div",{className:"p-4 border-b bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"font-medium",children:"Quiz Discussion"}),a.jsx(n.z,{variant:"ghost",size:"sm",onClick:()=>E(!1),children:a.jsx(p.Z,{className:"h-4 w-4"})})]})}),a.jsx("div",{className:"flex-1",children:a.jsx(v.N,{roomId:T,userId:s})})]})})]})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white shadow-sm border-b",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)(n.z,{variant:"ghost",onClick:()=>y.back(),className:"mr-4",children:[a.jsx(h.Z,{className:"h-4 w-4 mr-2"}),"Back"]}),a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:e.title})]}),e.enableChat&&t.length>0&&(0,a.jsxs)(n.z,{variant:"outline",onClick:()=>{F||E(!O)},className:"btn-secondary-professional",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-2"}),O?"Hide Chat":"Show Chat"]})]})})}),(0,a.jsxs)("div",{className:`flex ${O?"h-screen":""}`,children:[a.jsx("div",{className:`${O?"flex-1":"w-full"} overflow-auto`,children:a.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)(r.Zb,{className:"mb-8",children:[(0,a.jsxs)(r.Ol,{children:[a.jsx(r.ll,{className:"text-2xl",children:"Ready to Start?"}),a.jsx(r.SZ,{children:'Review the quiz details below and click "Start Quiz" when you\'re ready.'})]}),(0,a.jsxs)(r.aY,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Questions:"}),a.jsx("span",{className:"ml-2 font-medium",children:e.questions.length})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Passing Score:"}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:[e.passingScore,"%"]})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Time Limit:"}),a.jsx("span",{className:"ml-2 font-medium",children:e.timeLimit?`${e.timeLimit} minutes`:"No limit"})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Created by:"}),a.jsx("span",{className:"ml-2 font-medium",children:e.creator.name})]}),e.enableChat&&(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Chat:"}),(0,a.jsxs)(o.C,{variant:"default",className:"ml-2 bg-green-100 text-green-800",children:[a.jsx(u.Z,{className:"h-3 w-3 mr-1"}),"Available for discussion"]})]})]})]}),e.enableChat&&(0,a.jsxs)(x.bZ,{className:"mb-6",children:[a.jsx(u.Z,{className:"h-4 w-4"}),(0,a.jsxs)(x.X,{children:[a.jsx("strong",{children:"Academic Integrity Notice:"})," Chat will be disabled during the quiz attempt to maintain academic integrity. You can use chat before starting and after completing the quiz for discussions and questions."]})]}),(0,a.jsxs)(n.z,{onClick:()=>{Q(!0),E(!1)},size:"lg",className:"btn-primary-professional",children:[a.jsx(j.Z,{className:"h-5 w-5 mr-2"}),"Start Quiz"]})]})]})})}),O&&e.enableChat&&T&&a.jsx("div",{className:"w-96 border-l bg-white",children:(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"p-4 border-b bg-gray-50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"font-medium",children:"Quiz Discussion"}),a.jsx(n.z,{variant:"ghost",size:"sm",onClick:()=>E(!1),children:a.jsx(p.Z,{className:"h-4 w-4"})})]}),t.length>1&&a.jsx("div",{className:"mt-2",children:a.jsx("select",{value:T,onChange:e=>D(e.target.value),className:"w-full text-sm border rounded px-2 py-1",children:t.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.type,")"]},e.id))})})]}),a.jsx("div",{className:"flex-1",children:a.jsx(v.N,{roomId:T,userId:s})})]})})]})]})}},46582:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var a=t(19510),i=t(58585),l=t(95456),n=t(13538);let r=(0,t(68570).createProxy)(String.raw`C:\Users\HP\Documents\InfTech-quiz-management-system\src\components\student\quiz-interface-with-chat.tsx#QuizInterfaceWithChat`);async function c({params:e}){try{let s=await (0,l.MH)("STUDENT"),t=await n._.quiz.findFirst({where:{id:e.id,OR:[{isActive:!0},{startAt:{lte:new Date}}]},include:{questions:{include:{options:!0},orderBy:{order:"asc"}},creator:{select:{name:!0}}}});t||(0,i.redirect)("/student/dashboard"),t.enableChat||(0,i.redirect)(`/student/quiz/${e.id}`);let c=await n._.chatRoom.findMany({where:{OR:[{quizId:e.id},{type:"GENERAL",isActive:!0}]},select:{id:!0,name:!0,type:!0,isActive:!0},orderBy:[{type:"asc"},{createdAt:"desc"}]});return await n._.quizAttempt.findFirst({where:{userId:s.id,quizId:e.id,completedAt:{not:null}}}),a.jsx(r,{quiz:t,userId:s.id,chatRooms:c})}catch(e){console.error("Authentication error in quiz chat page:",e),(0,i.redirect)("/student")}}}};var s=require("../../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[9276,1615,349,9735,3644,8875,6306,5463],()=>t(16534));module.exports=a})();