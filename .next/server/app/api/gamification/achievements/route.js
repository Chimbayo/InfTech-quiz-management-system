"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/gamification/achievements/route";
exports.ids = ["app/api/gamification/achievements/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgamification%2Fachievements%2Froute&page=%2Fapi%2Fgamification%2Fachievements%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgamification%2Fachievements%2Froute.ts&appDir=C%3A%5CUsers%5CHP%5CDocuments%5CInfTech-quiz-management-system%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CHP%5CDocuments%5CInfTech-quiz-management-system&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgamification%2Fachievements%2Froute&page=%2Fapi%2Fgamification%2Fachievements%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgamification%2Fachievements%2Froute.ts&appDir=C%3A%5CUsers%5CHP%5CDocuments%5CInfTech-quiz-management-system%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CHP%5CDocuments%5CInfTech-quiz-management-system&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_HP_Documents_InfTech_quiz_management_system_src_app_api_gamification_achievements_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/gamification/achievements/route.ts */ \"(rsc)/./src/app/api/gamification/achievements/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/gamification/achievements/route\",\n        pathname: \"/api/gamification/achievements\",\n        filename: \"route\",\n        bundlePath: \"app/api/gamification/achievements/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\HP\\\\Documents\\\\InfTech-quiz-management-system\\\\src\\\\app\\\\api\\\\gamification\\\\achievements\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_HP_Documents_InfTech_quiz_management_system_src_app_api_gamification_achievements_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/gamification/achievements/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZnYW1pZmljYXRpb24lMkZhY2hpZXZlbWVudHMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmdhbWlmaWNhdGlvbiUyRmFjaGlldmVtZW50cyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmdhbWlmaWNhdGlvbiUyRmFjaGlldmVtZW50cyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNIUCU1Q0RvY3VtZW50cyU1Q0luZlRlY2gtcXVpei1tYW5hZ2VtZW50LXN5c3RlbSU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDSFAlNUNEb2N1bWVudHMlNUNJbmZUZWNoLXF1aXotbWFuYWdlbWVudC1zeXN0ZW0maXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzZEO0FBQzFJO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcXVpei1tYW5hZ2VtZW50LXN5c3RlbS8/N2Q5OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxIUFxcXFxEb2N1bWVudHNcXFxcSW5mVGVjaC1xdWl6LW1hbmFnZW1lbnQtc3lzdGVtXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGdhbWlmaWNhdGlvblxcXFxhY2hpZXZlbWVudHNcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2dhbWlmaWNhdGlvbi9hY2hpZXZlbWVudHMvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9nYW1pZmljYXRpb24vYWNoaWV2ZW1lbnRzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9nYW1pZmljYXRpb24vYWNoaWV2ZW1lbnRzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcSFBcXFxcRG9jdW1lbnRzXFxcXEluZlRlY2gtcXVpei1tYW5hZ2VtZW50LXN5c3RlbVxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxnYW1pZmljYXRpb25cXFxcYWNoaWV2ZW1lbnRzXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9nYW1pZmljYXRpb24vYWNoaWV2ZW1lbnRzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgamification%2Fachievements%2Froute&page=%2Fapi%2Fgamification%2Fachievements%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgamification%2Fachievements%2Froute.ts&appDir=C%3A%5CUsers%5CHP%5CDocuments%5CInfTech-quiz-management-system%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CHP%5CDocuments%5CInfTech-quiz-management-system&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/gamification/achievements/route.ts":
/*!********************************************************!*\
  !*** ./src/app/api/gamification/achievements/route.ts ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n\n\n\n// Achievement types and criteria\nconst ACHIEVEMENT_DEFINITIONS = {\n    STUDY_STREAK: {\n        name: \"Study Streak Master\",\n        description: \"Complete quizzes on consecutive days\",\n        levels: [\n            {\n                level: 1,\n                requirement: 3,\n                badge: \"\\uD83D\\uDD25\",\n                title: \"Getting Started\"\n            },\n            {\n                level: 2,\n                requirement: 7,\n                badge: \"\\uD83C\\uDF1F\",\n                title: \"Week Warrior\"\n            },\n            {\n                level: 3,\n                requirement: 14,\n                badge: \"\\uD83D\\uDC8E\",\n                title: \"Fortnight Fighter\"\n            },\n            {\n                level: 4,\n                requirement: 30,\n                badge: \"\\uD83D\\uDC51\",\n                title: \"Monthly Master\"\n            }\n        ]\n    },\n    PEER_HELPER: {\n        name: \"Peer Helper\",\n        description: \"Help other students in chat discussions\",\n        levels: [\n            {\n                level: 1,\n                requirement: 5,\n                badge: \"\\uD83E\\uDD1D\",\n                title: \"Helpful Friend\"\n            },\n            {\n                level: 2,\n                requirement: 15,\n                badge: \"\\uD83D\\uDCAA\",\n                title: \"Study Buddy\"\n            },\n            {\n                level: 3,\n                requirement: 30,\n                badge: \"\\uD83C\\uDF93\",\n                title: \"Mentor\"\n            },\n            {\n                level: 4,\n                requirement: 50,\n                badge: \"\\uD83C\\uDFC6\",\n                title: \"Teaching Assistant\"\n            }\n        ]\n    },\n    QUIZ_MASTERY: {\n        name: \"Quiz Mastery\",\n        description: \"Achieve high scores consistently\",\n        levels: [\n            {\n                level: 1,\n                requirement: 5,\n                badge: \"\\uD83D\\uDCDA\",\n                title: \"Good Student\"\n            },\n            {\n                level: 2,\n                requirement: 10,\n                badge: \"\\uD83C\\uDFAF\",\n                title: \"Focused Learner\"\n            },\n            {\n                level: 3,\n                requirement: 20,\n                badge: \"\\uD83E\\uDDE0\",\n                title: \"Knowledge Seeker\"\n            },\n            {\n                level: 4,\n                requirement: 30,\n                badge: \"\\uD83C\\uDF1F\",\n                title: \"Quiz Master\"\n            }\n        ]\n    },\n    STUDY_GROUP_LEADER: {\n        name: \"Study Group Leader\",\n        description: \"Active participation in study groups\",\n        levels: [\n            {\n                level: 1,\n                requirement: 10,\n                badge: \"\\uD83D\\uDC65\",\n                title: \"Team Player\"\n            },\n            {\n                level: 2,\n                requirement: 25,\n                badge: \"\\uD83D\\uDDE3️\",\n                title: \"Discussion Leader\"\n            },\n            {\n                level: 3,\n                requirement: 50,\n                badge: \"\\uD83C\\uDFAA\",\n                title: \"Group Facilitator\"\n            },\n            {\n                level: 4,\n                requirement: 100,\n                badge: \"\\uD83D\\uDC68‍\\uD83C\\uDFEB\",\n                title: \"Study Group Champion\"\n            }\n        ]\n    },\n    CHAT_ENGAGEMENT: {\n        name: \"Chat Engagement\",\n        description: \"Active participation in educational discussions\",\n        levels: [\n            {\n                level: 1,\n                requirement: 20,\n                badge: \"\\uD83D\\uDCAC\",\n                title: \"Chatty Student\"\n            },\n            {\n                level: 2,\n                requirement: 50,\n                badge: \"\\uD83D\\uDDE8️\",\n                title: \"Discussion Enthusiast\"\n            },\n            {\n                level: 3,\n                requirement: 100,\n                badge: \"\\uD83D\\uDCE2\",\n                title: \"Communication Expert\"\n            },\n            {\n                level: 4,\n                requirement: 200,\n                badge: \"\\uD83C\\uDF99️\",\n                title: \"Chat Champion\"\n            }\n        ]\n    }\n};\n// GET /api/gamification/achievements - Get user achievements\nasync function GET(request) {\n    try {\n        const session = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.getSession)();\n        if (!session?.id) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        const { searchParams } = new URL(request.url);\n        const userId = searchParams.get(\"userId\") || session.id;\n        // Calculate achievements based on user activity\n        const achievements = await calculateUserAchievements(userId);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(achievements);\n    } catch (error) {\n        console.error(\"Error fetching achievements:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function calculateUserAchievements(userId) {\n    const achievements = [];\n    // 1. Study Streak Achievement\n    const studyStreak = await calculateStudyStreak(userId);\n    const streakAchievement = getAchievementLevel(\"STUDY_STREAK\", studyStreak);\n    if (streakAchievement) {\n        achievements.push({\n            type: \"STUDY_STREAK\",\n            ...streakAchievement,\n            currentValue: studyStreak,\n            earnedAt: new Date()\n        });\n    }\n    // 2. Peer Helper Achievement\n    const helpfulMessages = await countHelpfulMessages(userId);\n    const helperAchievement = getAchievementLevel(\"PEER_HELPER\", helpfulMessages);\n    if (helperAchievement) {\n        achievements.push({\n            type: \"PEER_HELPER\",\n            ...helperAchievement,\n            currentValue: helpfulMessages,\n            earnedAt: new Date()\n        });\n    }\n    // 3. Quiz Mastery Achievement\n    const highScoreCount = await countHighScoreQuizzes(userId);\n    const masteryAchievement = getAchievementLevel(\"QUIZ_MASTERY\", highScoreCount);\n    if (masteryAchievement) {\n        achievements.push({\n            type: \"QUIZ_MASTERY\",\n            ...masteryAchievement,\n            currentValue: highScoreCount,\n            earnedAt: new Date()\n        });\n    }\n    // 4. Study Group Leader Achievement\n    const studyGroupMessages = await countStudyGroupMessages(userId);\n    const leaderAchievement = getAchievementLevel(\"STUDY_GROUP_LEADER\", studyGroupMessages);\n    if (leaderAchievement) {\n        achievements.push({\n            type: \"STUDY_GROUP_LEADER\",\n            ...leaderAchievement,\n            currentValue: studyGroupMessages,\n            earnedAt: new Date()\n        });\n    }\n    // 5. Chat Engagement Achievement\n    const totalMessages = await countTotalMessages(userId);\n    const chatAchievement = getAchievementLevel(\"CHAT_ENGAGEMENT\", totalMessages);\n    if (chatAchievement) {\n        achievements.push({\n            type: \"CHAT_ENGAGEMENT\",\n            ...chatAchievement,\n            currentValue: totalMessages,\n            earnedAt: new Date()\n        });\n    }\n    return {\n        achievements,\n        totalPoints: achievements.reduce((sum, ach)=>sum + ach.level * 10, 0),\n        nextAchievements: getNextAchievements(userId)\n    };\n}\nasync function calculateStudyStreak(userId) {\n    const attempts = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.quizAttempt.findMany({\n        where: {\n            userId,\n            completedAt: {\n                not: null\n            }\n        },\n        orderBy: {\n            completedAt: \"desc\"\n        },\n        select: {\n            completedAt: true\n        }\n    });\n    if (attempts.length === 0) return 0;\n    let streak = 0;\n    let currentDate = new Date();\n    currentDate.setHours(0, 0, 0, 0);\n    for (const attempt of attempts){\n        const attemptDate = new Date(attempt.completedAt);\n        attemptDate.setHours(0, 0, 0, 0);\n        const daysDiff = Math.floor((currentDate.getTime() - attemptDate.getTime()) / (1000 * 60 * 60 * 24));\n        if (daysDiff === streak) {\n            streak++;\n        } else if (daysDiff > streak) {\n            break;\n        }\n    }\n    return streak;\n}\nasync function countHelpfulMessages(userId) {\n    // Count messages that contain helpful keywords or are responses to questions\n    const helpfulMessages = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.chatMessage.count({\n        where: {\n            userId,\n            OR: [\n                {\n                    content: {\n                        contains: \"help\"\n                    }\n                },\n                {\n                    content: {\n                        contains: \"explain\"\n                    }\n                },\n                {\n                    content: {\n                        contains: \"answer\"\n                    }\n                },\n                {\n                    content: {\n                        contains: \"solution\"\n                    }\n                },\n                {\n                    replyToId: {\n                        not: null\n                    }\n                }\n            ],\n            isDeleted: false\n        }\n    });\n    return helpfulMessages;\n}\nasync function countHighScoreQuizzes(userId) {\n    const highScoreAttempts = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.quizAttempt.count({\n        where: {\n            userId,\n            score: {\n                gte: 80\n            },\n            completedAt: {\n                not: null\n            }\n        }\n    });\n    return highScoreAttempts;\n}\nasync function countStudyGroupMessages(userId) {\n    const studyGroupMessages = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.chatMessage.count({\n        where: {\n            userId,\n            room: {\n                type: \"STUDY_GROUP\"\n            },\n            isDeleted: false\n        }\n    });\n    return studyGroupMessages;\n}\nasync function countTotalMessages(userId) {\n    const totalMessages = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.chatMessage.count({\n        where: {\n            userId,\n            isDeleted: false,\n            isSystemMessage: false\n        }\n    });\n    return totalMessages;\n}\nfunction getAchievementLevel(type, value) {\n    const definition = ACHIEVEMENT_DEFINITIONS[type];\n    const levels = definition.levels.filter((level)=>value >= level.requirement);\n    if (levels.length === 0) return null;\n    const highestLevel = levels[levels.length - 1];\n    return {\n        ...definition,\n        level: highestLevel.level,\n        badge: highestLevel.badge,\n        title: highestLevel.title,\n        requirement: highestLevel.requirement\n    };\n}\nasync function getNextAchievements(userId) {\n    const nextAchievements = [];\n    for (const [type, definition] of Object.entries(ACHIEVEMENT_DEFINITIONS)){\n        let currentValue = 0;\n        switch(type){\n            case \"STUDY_STREAK\":\n                currentValue = await calculateStudyStreak(userId);\n                break;\n            case \"PEER_HELPER\":\n                currentValue = await countHelpfulMessages(userId);\n                break;\n            case \"QUIZ_MASTERY\":\n                currentValue = await countHighScoreQuizzes(userId);\n                break;\n            case \"STUDY_GROUP_LEADER\":\n                currentValue = await countStudyGroupMessages(userId);\n                break;\n            case \"CHAT_ENGAGEMENT\":\n                currentValue = await countTotalMessages(userId);\n                break;\n        }\n        const nextLevel = definition.levels.find((level)=>currentValue < level.requirement);\n        if (nextLevel) {\n            nextAchievements.push({\n                type,\n                name: definition.name,\n                description: definition.description,\n                nextLevel: nextLevel.level,\n                nextBadge: nextLevel.badge,\n                nextTitle: nextLevel.title,\n                requirement: nextLevel.requirement,\n                currentValue,\n                progress: currentValue / nextLevel.requirement * 100\n            });\n        }\n    }\n    return nextAchievements;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9nYW1pZmljYXRpb24vYWNoaWV2ZW1lbnRzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBdUQ7QUFDbEI7QUFDRTtBQUV2QyxpQ0FBaUM7QUFDakMsTUFBTUcsMEJBQTBCO0lBQzlCQyxjQUFjO1FBQ1pDLE1BQU07UUFDTkMsYUFBYTtRQUNiQyxRQUFRO1lBQ047Z0JBQUVDLE9BQU87Z0JBQUdDLGFBQWE7Z0JBQUdDLE9BQU87Z0JBQU1DLE9BQU87WUFBa0I7WUFDbEU7Z0JBQUVILE9BQU87Z0JBQUdDLGFBQWE7Z0JBQUdDLE9BQU87Z0JBQU1DLE9BQU87WUFBZTtZQUMvRDtnQkFBRUgsT0FBTztnQkFBR0MsYUFBYTtnQkFBSUMsT0FBTztnQkFBTUMsT0FBTztZQUFvQjtZQUNyRTtnQkFBRUgsT0FBTztnQkFBR0MsYUFBYTtnQkFBSUMsT0FBTztnQkFBTUMsT0FBTztZQUFpQjtTQUNuRTtJQUNIO0lBQ0FDLGFBQWE7UUFDWFAsTUFBTTtRQUNOQyxhQUFhO1FBQ2JDLFFBQVE7WUFDTjtnQkFBRUMsT0FBTztnQkFBR0MsYUFBYTtnQkFBR0MsT0FBTztnQkFBTUMsT0FBTztZQUFpQjtZQUNqRTtnQkFBRUgsT0FBTztnQkFBR0MsYUFBYTtnQkFBSUMsT0FBTztnQkFBTUMsT0FBTztZQUFjO1lBQy9EO2dCQUFFSCxPQUFPO2dCQUFHQyxhQUFhO2dCQUFJQyxPQUFPO2dCQUFNQyxPQUFPO1lBQVM7WUFDMUQ7Z0JBQUVILE9BQU87Z0JBQUdDLGFBQWE7Z0JBQUlDLE9BQU87Z0JBQU1DLE9BQU87WUFBcUI7U0FDdkU7SUFDSDtJQUNBRSxjQUFjO1FBQ1pSLE1BQU07UUFDTkMsYUFBYTtRQUNiQyxRQUFRO1lBQ047Z0JBQUVDLE9BQU87Z0JBQUdDLGFBQWE7Z0JBQUdDLE9BQU87Z0JBQU1DLE9BQU87WUFBZTtZQUMvRDtnQkFBRUgsT0FBTztnQkFBR0MsYUFBYTtnQkFBSUMsT0FBTztnQkFBTUMsT0FBTztZQUFrQjtZQUNuRTtn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QUFLO2dCQUNIVyxlQUFlLE1BQU1JLHFCQUFxQmY7Z0JBQzFDO1lBQ0YsS0FBSztnQkFDSFcsZUFBZSxNQUFNTyxzQkFBc0JsQjtnQkFDM0M7WUFDRixLQUFLO2dCQUNIVyxlQUFlLE1BQU1VLHdCQUF3QnJCO2dCQUM3QztZQUNGLEtBQUs7Z0JBQ0hXLGVBQWUsTUFBTWEsbUJBQW1CeEI7Z0JBQ3hDO1FBQ0o7UUFFQSxNQUFNb0UsWUFBWUwsV0FBV2xGLE1BQU0sQ0FBQ3dGLElBQUksQ0FBQ3ZGLENBQUFBLFFBQVM2QixlQUFlN0IsTUFBTUMsV0FBVztRQUVsRixJQUFJcUYsV0FBVztZQUNidEMsaUJBQWlCckIsSUFBSSxDQUFDO2dCQUNwQkM7Z0JBQ0EvQixNQUFNb0YsV0FBV3BGLElBQUk7Z0JBQ3JCQyxhQUFhbUYsV0FBV25GLFdBQVc7Z0JBQ25Dd0YsV0FBV0EsVUFBVXRGLEtBQUs7Z0JBQzFCd0YsV0FBV0YsVUFBVXBGLEtBQUs7Z0JBQzFCdUYsV0FBV0gsVUFBVW5GLEtBQUs7Z0JBQzFCRixhQUFhcUYsVUFBVXJGLFdBQVc7Z0JBQ2xDNEI7Z0JBQ0E2RCxVQUFVLGVBQWdCSixVQUFVckYsV0FBVyxHQUFJO1lBQ3JEO1FBQ0Y7SUFDRjtJQUVBLE9BQU8rQztBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcXVpei1tYW5hZ2VtZW50LXN5c3RlbS8uL3NyYy9hcHAvYXBpL2dhbWlmaWNhdGlvbi9hY2hpZXZlbWVudHMvcm91dGUudHM/MzExNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICdAL2xpYi9wcmlzbWEnXG5pbXBvcnQgeyBnZXRTZXNzaW9uIH0gZnJvbSAnQC9saWIvYXV0aCdcblxuLy8gQWNoaWV2ZW1lbnQgdHlwZXMgYW5kIGNyaXRlcmlhXG5jb25zdCBBQ0hJRVZFTUVOVF9ERUZJTklUSU9OUyA9IHtcbiAgU1RVRFlfU1RSRUFLOiB7XG4gICAgbmFtZTogJ1N0dWR5IFN0cmVhayBNYXN0ZXInLFxuICAgIGRlc2NyaXB0aW9uOiAnQ29tcGxldGUgcXVpenplcyBvbiBjb25zZWN1dGl2ZSBkYXlzJyxcbiAgICBsZXZlbHM6IFtcbiAgICAgIHsgbGV2ZWw6IDEsIHJlcXVpcmVtZW50OiAzLCBiYWRnZTogJ/CflKUnLCB0aXRsZTogJ0dldHRpbmcgU3RhcnRlZCcgfSxcbiAgICAgIHsgbGV2ZWw6IDIsIHJlcXVpcmVtZW50OiA3LCBiYWRnZTogJ/CfjJ8nLCB0aXRsZTogJ1dlZWsgV2FycmlvcicgfSxcbiAgICAgIHsgbGV2ZWw6IDMsIHJlcXVpcmVtZW50OiAxNCwgYmFkZ2U6ICfwn5KOJywgdGl0bGU6ICdGb3J0bmlnaHQgRmlnaHRlcicgfSxcbiAgICAgIHsgbGV2ZWw6IDQsIHJlcXVpcmVtZW50OiAzMCwgYmFkZ2U6ICfwn5GRJywgdGl0bGU6ICdNb250aGx5IE1hc3RlcicgfVxuICAgIF1cbiAgfSxcbiAgUEVFUl9IRUxQRVI6IHtcbiAgICBuYW1lOiAnUGVlciBIZWxwZXInLFxuICAgIGRlc2NyaXB0aW9uOiAnSGVscCBvdGhlciBzdHVkZW50cyBpbiBjaGF0IGRpc2N1c3Npb25zJyxcbiAgICBsZXZlbHM6IFtcbiAgICAgIHsgbGV2ZWw6IDEsIHJlcXVpcmVtZW50OiA1LCBiYWRnZTogJ/CfpJ0nLCB0aXRsZTogJ0hlbHBmdWwgRnJpZW5kJyB9LFxuICAgICAgeyBsZXZlbDogMiwgcmVxdWlyZW1lbnQ6IDE1LCBiYWRnZTogJ/CfkqonLCB0aXRsZTogJ1N0dWR5IEJ1ZGR5JyB9LFxuICAgICAgeyBsZXZlbDogMywgcmVxdWlyZW1lbnQ6IDMwLCBiYWRnZTogJ/CfjpMnLCB0aXRsZTogJ01lbnRvcicgfSxcbiAgICAgIHsgbGV2ZWw6IDQsIHJlcXVpcmVtZW50OiA1MCwgYmFkZ2U6ICfwn4+GJywgdGl0bGU6ICdUZWFjaGluZyBBc3Npc3RhbnQnIH1cbiAgICBdXG4gIH0sXG4gIFFVSVpfTUFTVEVSWToge1xuICAgIG5hbWU6ICdRdWl6IE1hc3RlcnknLFxuICAgIGRlc2NyaXB0aW9uOiAnQWNoaWV2ZSBoaWdoIHNjb3JlcyBjb25zaXN0ZW50bHknLFxuICAgIGxldmVsczogW1xuICAgICAgeyBsZXZlbDogMSwgcmVxdWlyZW1lbnQ6IDUsIGJhZGdlOiAn8J+TmicsIHRpdGxlOiAnR29vZCBTdHVkZW50JyB9LFxuICAgICAgeyBsZXZlbDogMiwgcmVxdWlyZW1lbnQ6IDEwLCBiYWRnZTogJ/Cfjq8nLCB0aXRsZTogJ0ZvY3VzZWQgTGVhcm5lcicgfSxcbiAgICAgIHsgbGV2ZWw6IDMsIHJlcXVpcmVtZW50OiAyMCwgYmFkZ2U6ICfwn6egJywgdGl0bGU6ICdLbm93bGVkZ2UgU2Vla2VyJyB9LFxuICAgICAgeyBsZXZlbDogNCwgcmVxdWlyZW1lbnQ6IDMwLCBiYWRnZTogJ/CfjJ8nLCB0aXRsZTogJ1F1aXogTWFzdGVyJyB9XG4gICAgXVxuICB9LFxuICBTVFVEWV9HUk9VUF9MRUFERVI6IHtcbiAgICBuYW1lOiAnU3R1ZHkgR3JvdXAgTGVhZGVyJyxcbiAgICBkZXNjcmlwdGlvbjogJ0FjdGl2ZSBwYXJ0aWNpcGF0aW9uIGluIHN0dWR5IGdyb3VwcycsXG4gICAgbGV2ZWxzOiBbXG4gICAgICB7IGxldmVsOiAxLCByZXF1aXJlbWVudDogMTAsIGJhZGdlOiAn8J+RpScsIHRpdGxlOiAnVGVhbSBQbGF5ZXInIH0sXG4gICAgICB7IGxldmVsOiAyLCByZXF1aXJlbWVudDogMjUsIGJhZGdlOiAn8J+Xo++4jycsIHRpdGxlOiAnRGlzY3Vzc2lvbiBMZWFkZXInIH0sXG4gICAgICB7IGxldmVsOiAzLCByZXF1aXJlbWVudDogNTAsIGJhZGdlOiAn8J+OqicsIHRpdGxlOiAnR3JvdXAgRmFjaWxpdGF0b3InIH0sXG4gICAgICB7IGxldmVsOiA0LCByZXF1aXJlbWVudDogMTAwLCBiYWRnZTogJ/CfkajigI3wn4+rJywgdGl0bGU6ICdTdHVkeSBHcm91cCBDaGFtcGlvbicgfVxuICAgIF1cbiAgfSxcbiAgQ0hBVF9FTkdBR0VNRU5UOiB7XG4gICAgbmFtZTogJ0NoYXQgRW5nYWdlbWVudCcsXG4gICAgZGVzY3JpcHRpb246ICdBY3RpdmUgcGFydGljaXBhdGlvbiBpbiBlZHVjYXRpb25hbCBkaXNjdXNzaW9ucycsXG4gICAgbGV2ZWxzOiBbXG4gICAgICB7IGxldmVsOiAxLCByZXF1aXJlbWVudDogMjAsIGJhZGdlOiAn8J+SrCcsIHRpdGxlOiAnQ2hhdHR5IFN0dWRlbnQnIH0sXG4gICAgICB7IGxldmVsOiAyLCByZXF1aXJlbWVudDogNTAsIGJhZGdlOiAn8J+XqO+4jycsIHRpdGxlOiAnRGlzY3Vzc2lvbiBFbnRodXNpYXN0JyB9LFxuICAgICAgeyBsZXZlbDogMywgcmVxdWlyZW1lbnQ6IDEwMCwgYmFkZ2U6ICfwn5OiJywgdGl0bGU6ICdDb21tdW5pY2F0aW9uIEV4cGVydCcgfSxcbiAgICAgIHsgbGV2ZWw6IDQsIHJlcXVpcmVtZW50OiAyMDAsIGJhZGdlOiAn8J+Ome+4jycsIHRpdGxlOiAnQ2hhdCBDaGFtcGlvbicgfVxuICAgIF1cbiAgfVxufVxuXG4vLyBHRVQgL2FwaS9nYW1pZmljYXRpb24vYWNoaWV2ZW1lbnRzIC0gR2V0IHVzZXIgYWNoaWV2ZW1lbnRzXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb24oKVxuICAgIGlmICghc2Vzc2lvbj8uaWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pXG4gICAgfVxuXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpXG4gICAgY29uc3QgdXNlcklkID0gc2VhcmNoUGFyYW1zLmdldCgndXNlcklkJykgfHwgc2Vzc2lvbi5pZFxuXG4gICAgLy8gQ2FsY3VsYXRlIGFjaGlldmVtZW50cyBiYXNlZCBvbiB1c2VyIGFjdGl2aXR5XG4gICAgY29uc3QgYWNoaWV2ZW1lbnRzID0gYXdhaXQgY2FsY3VsYXRlVXNlckFjaGlldmVtZW50cyh1c2VySWQpXG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGFjaGlldmVtZW50cylcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBhY2hpZXZlbWVudHM6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sIHsgc3RhdHVzOiA1MDAgfSlcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBjYWxjdWxhdGVVc2VyQWNoaWV2ZW1lbnRzKHVzZXJJZDogc3RyaW5nKSB7XG4gIGNvbnN0IGFjaGlldmVtZW50cyA9IFtdXG5cbiAgLy8gMS4gU3R1ZHkgU3RyZWFrIEFjaGlldmVtZW50XG4gIGNvbnN0IHN0dWR5U3RyZWFrID0gYXdhaXQgY2FsY3VsYXRlU3R1ZHlTdHJlYWsodXNlcklkKVxuICBjb25zdCBzdHJlYWtBY2hpZXZlbWVudCA9IGdldEFjaGlldmVtZW50TGV2ZWwoJ1NUVURZX1NUUkVBSycsIHN0dWR5U3RyZWFrKVxuICBpZiAoc3RyZWFrQWNoaWV2ZW1lbnQpIHtcbiAgICBhY2hpZXZlbWVudHMucHVzaCh7XG4gICAgICB0eXBlOiAnU1RVRFlfU1RSRUFLJyxcbiAgICAgIC4uLnN0cmVha0FjaGlldmVtZW50LFxuICAgICAgY3VycmVudFZhbHVlOiBzdHVkeVN0cmVhayxcbiAgICAgIGVhcm5lZEF0OiBuZXcgRGF0ZSgpXG4gICAgfSlcbiAgfVxuXG4gIC8vIDIuIFBlZXIgSGVscGVyIEFjaGlldmVtZW50XG4gIGNvbnN0IGhlbHBmdWxNZXNzYWdlcyA9IGF3YWl0IGNvdW50SGVscGZ1bE1lc3NhZ2VzKHVzZXJJZClcbiAgY29uc3QgaGVscGVyQWNoaWV2ZW1lbnQgPSBnZXRBY2hpZXZlbWVudExldmVsKCdQRUVSX0hFTFBFUicsIGhlbHBmdWxNZXNzYWdlcylcbiAgaWYgKGhlbHBlckFjaGlldmVtZW50KSB7XG4gICAgYWNoaWV2ZW1lbnRzLnB1c2goe1xuICAgICAgdHlwZTogJ1BFRVJfSEVMUEVSJyxcbiAgICAgIC4uLmhlbHBlckFjaGlldmVtZW50LFxuICAgICAgY3VycmVudFZhbHVlOiBoZWxwZnVsTWVzc2FnZXMsXG4gICAgICBlYXJuZWRBdDogbmV3IERhdGUoKVxuICAgIH0pXG4gIH1cblxuICAvLyAzLiBRdWl6IE1hc3RlcnkgQWNoaWV2ZW1lbnRcbiAgY29uc3QgaGlnaFNjb3JlQ291bnQgPSBhd2FpdCBjb3VudEhpZ2hTY29yZVF1aXp6ZXModXNlcklkKVxuICBjb25zdCBtYXN0ZXJ5QWNoaWV2ZW1lbnQgPSBnZXRBY2hpZXZlbWVudExldmVsKCdRVUlaX01BU1RFUlknLCBoaWdoU2NvcmVDb3VudClcbiAgaWYgKG1hc3RlcnlBY2hpZXZlbWVudCkge1xuICAgIGFjaGlldmVtZW50cy5wdXNoKHtcbiAgICAgIHR5cGU6ICdRVUlaX01BU1RFUlknLFxuICAgICAgLi4ubWFzdGVyeUFjaGlldmVtZW50LFxuICAgICAgY3VycmVudFZhbHVlOiBoaWdoU2NvcmVDb3VudCxcbiAgICAgIGVhcm5lZEF0OiBuZXcgRGF0ZSgpXG4gICAgfSlcbiAgfVxuXG4gIC8vIDQuIFN0dWR5IEdyb3VwIExlYWRlciBBY2hpZXZlbWVudFxuICBjb25zdCBzdHVkeUdyb3VwTWVzc2FnZXMgPSBhd2FpdCBjb3VudFN0dWR5R3JvdXBNZXNzYWdlcyh1c2VySWQpXG4gIGNvbnN0IGxlYWRlckFjaGlldmVtZW50ID0gZ2V0QWNoaWV2ZW1lbnRMZXZlbCgnU1RVRFlfR1JPVVBfTEVBREVSJywgc3R1ZHlHcm91cE1lc3NhZ2VzKVxuICBpZiAobGVhZGVyQWNoaWV2ZW1lbnQpIHtcbiAgICBhY2hpZXZlbWVudHMucHVzaCh7XG4gICAgICB0eXBlOiAnU1RVRFlfR1JPVVBfTEVBREVSJyxcbiAgICAgIC4uLmxlYWRlckFjaGlldmVtZW50LFxuICAgICAgY3VycmVudFZhbHVlOiBzdHVkeUdyb3VwTWVzc2FnZXMsXG4gICAgICBlYXJuZWRBdDogbmV3IERhdGUoKVxuICAgIH0pXG4gIH1cblxuICAvLyA1LiBDaGF0IEVuZ2FnZW1lbnQgQWNoaWV2ZW1lbnRcbiAgY29uc3QgdG90YWxNZXNzYWdlcyA9IGF3YWl0IGNvdW50VG90YWxNZXNzYWdlcyh1c2VySWQpXG4gIGNvbnN0IGNoYXRBY2hpZXZlbWVudCA9IGdldEFjaGlldmVtZW50TGV2ZWwoJ0NIQVRfRU5HQUdFTUVOVCcsIHRvdGFsTWVzc2FnZXMpXG4gIGlmIChjaGF0QWNoaWV2ZW1lbnQpIHtcbiAgICBhY2hpZXZlbWVudHMucHVzaCh7XG4gICAgICB0eXBlOiAnQ0hBVF9FTkdBR0VNRU5UJyxcbiAgICAgIC4uLmNoYXRBY2hpZXZlbWVudCxcbiAgICAgIGN1cnJlbnRWYWx1ZTogdG90YWxNZXNzYWdlcyxcbiAgICAgIGVhcm5lZEF0OiBuZXcgRGF0ZSgpXG4gICAgfSlcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgYWNoaWV2ZW1lbnRzLFxuICAgIHRvdGFsUG9pbnRzOiBhY2hpZXZlbWVudHMucmVkdWNlKChzdW0sIGFjaCkgPT4gc3VtICsgKGFjaC5sZXZlbCAqIDEwKSwgMCksXG4gICAgbmV4dEFjaGlldmVtZW50czogZ2V0TmV4dEFjaGlldmVtZW50cyh1c2VySWQpXG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gY2FsY3VsYXRlU3R1ZHlTdHJlYWsodXNlcklkOiBzdHJpbmcpIHtcbiAgY29uc3QgYXR0ZW1wdHMgPSBhd2FpdCBwcmlzbWEucXVpekF0dGVtcHQuZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7IFxuICAgICAgdXNlcklkLFxuICAgICAgY29tcGxldGVkQXQ6IHsgbm90OiBudWxsIH1cbiAgICB9LFxuICAgIG9yZGVyQnk6IHsgY29tcGxldGVkQXQ6ICdkZXNjJyB9LFxuICAgIHNlbGVjdDogeyBjb21wbGV0ZWRBdDogdHJ1ZSB9XG4gIH0pXG5cbiAgaWYgKGF0dGVtcHRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDBcblxuICBsZXQgc3RyZWFrID0gMFxuICBsZXQgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpXG4gIGN1cnJlbnREYXRlLnNldEhvdXJzKDAsIDAsIDAsIDApXG5cbiAgZm9yIChjb25zdCBhdHRlbXB0IG9mIGF0dGVtcHRzKSB7XG4gICAgY29uc3QgYXR0ZW1wdERhdGUgPSBuZXcgRGF0ZShhdHRlbXB0LmNvbXBsZXRlZEF0ISlcbiAgICBhdHRlbXB0RGF0ZS5zZXRIb3VycygwLCAwLCAwLCAwKVxuICAgIFxuICAgIGNvbnN0IGRheXNEaWZmID0gTWF0aC5mbG9vcigoY3VycmVudERhdGUuZ2V0VGltZSgpIC0gYXR0ZW1wdERhdGUuZ2V0VGltZSgpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSlcbiAgICBcbiAgICBpZiAoZGF5c0RpZmYgPT09IHN0cmVhaykge1xuICAgICAgc3RyZWFrKytcbiAgICB9IGVsc2UgaWYgKGRheXNEaWZmID4gc3RyZWFrKSB7XG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIHN0cmVha1xufVxuXG5hc3luYyBmdW5jdGlvbiBjb3VudEhlbHBmdWxNZXNzYWdlcyh1c2VySWQ6IHN0cmluZykge1xuICAvLyBDb3VudCBtZXNzYWdlcyB0aGF0IGNvbnRhaW4gaGVscGZ1bCBrZXl3b3JkcyBvciBhcmUgcmVzcG9uc2VzIHRvIHF1ZXN0aW9uc1xuICBjb25zdCBoZWxwZnVsTWVzc2FnZXMgPSBhd2FpdCBwcmlzbWEuY2hhdE1lc3NhZ2UuY291bnQoe1xuICAgIHdoZXJlOiB7XG4gICAgICB1c2VySWQsXG4gICAgICBPUjogW1xuICAgICAgICB7IGNvbnRlbnQ6IHsgY29udGFpbnM6ICdoZWxwJyB9IH0sXG4gICAgICAgIHsgY29udGVudDogeyBjb250YWluczogJ2V4cGxhaW4nIH0gfSxcbiAgICAgICAgeyBjb250ZW50OiB7IGNvbnRhaW5zOiAnYW5zd2VyJyB9IH0sXG4gICAgICAgIHsgY29udGVudDogeyBjb250YWluczogJ3NvbHV0aW9uJyB9IH0sXG4gICAgICAgIHsgcmVwbHlUb0lkOiB7IG5vdDogbnVsbCB9IH1cbiAgICAgIF0sXG4gICAgICBpc0RlbGV0ZWQ6IGZhbHNlXG4gICAgfVxuICB9KVxuXG4gIHJldHVybiBoZWxwZnVsTWVzc2FnZXNcbn1cblxuYXN5bmMgZnVuY3Rpb24gY291bnRIaWdoU2NvcmVRdWl6emVzKHVzZXJJZDogc3RyaW5nKSB7XG4gIGNvbnN0IGhpZ2hTY29yZUF0dGVtcHRzID0gYXdhaXQgcHJpc21hLnF1aXpBdHRlbXB0LmNvdW50KHtcbiAgICB3aGVyZToge1xuICAgICAgdXNlcklkLFxuICAgICAgc2NvcmU6IHsgZ3RlOiA4MCB9LFxuICAgICAgY29tcGxldGVkQXQ6IHsgbm90OiBudWxsIH1cbiAgICB9XG4gIH0pXG5cbiAgcmV0dXJuIGhpZ2hTY29yZUF0dGVtcHRzXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNvdW50U3R1ZHlHcm91cE1lc3NhZ2VzKHVzZXJJZDogc3RyaW5nKSB7XG4gIGNvbnN0IHN0dWR5R3JvdXBNZXNzYWdlcyA9IGF3YWl0IHByaXNtYS5jaGF0TWVzc2FnZS5jb3VudCh7XG4gICAgd2hlcmU6IHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIHJvb206IHtcbiAgICAgICAgdHlwZTogJ1NUVURZX0dST1VQJ1xuICAgICAgfSxcbiAgICAgIGlzRGVsZXRlZDogZmFsc2VcbiAgICB9XG4gIH0pXG5cbiAgcmV0dXJuIHN0dWR5R3JvdXBNZXNzYWdlc1xufVxuXG5hc3luYyBmdW5jdGlvbiBjb3VudFRvdGFsTWVzc2FnZXModXNlcklkOiBzdHJpbmcpIHtcbiAgY29uc3QgdG90YWxNZXNzYWdlcyA9IGF3YWl0IHByaXNtYS5jaGF0TWVzc2FnZS5jb3VudCh7XG4gICAgd2hlcmU6IHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIGlzRGVsZXRlZDogZmFsc2UsXG4gICAgICBpc1N5c3RlbU1lc3NhZ2U6IGZhbHNlXG4gICAgfVxuICB9KVxuXG4gIHJldHVybiB0b3RhbE1lc3NhZ2VzXG59XG5cbmZ1bmN0aW9uIGdldEFjaGlldmVtZW50TGV2ZWwodHlwZToga2V5b2YgdHlwZW9mIEFDSElFVkVNRU5UX0RFRklOSVRJT05TLCB2YWx1ZTogbnVtYmVyKSB7XG4gIGNvbnN0IGRlZmluaXRpb24gPSBBQ0hJRVZFTUVOVF9ERUZJTklUSU9OU1t0eXBlXVxuICBjb25zdCBsZXZlbHMgPSBkZWZpbml0aW9uLmxldmVscy5maWx0ZXIobGV2ZWwgPT4gdmFsdWUgPj0gbGV2ZWwucmVxdWlyZW1lbnQpXG4gIFxuICBpZiAobGV2ZWxzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGxcbiAgXG4gIGNvbnN0IGhpZ2hlc3RMZXZlbCA9IGxldmVsc1tsZXZlbHMubGVuZ3RoIC0gMV1cbiAgXG4gIHJldHVybiB7XG4gICAgLi4uZGVmaW5pdGlvbixcbiAgICBsZXZlbDogaGlnaGVzdExldmVsLmxldmVsLFxuICAgIGJhZGdlOiBoaWdoZXN0TGV2ZWwuYmFkZ2UsXG4gICAgdGl0bGU6IGhpZ2hlc3RMZXZlbC50aXRsZSxcbiAgICByZXF1aXJlbWVudDogaGlnaGVzdExldmVsLnJlcXVpcmVtZW50XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0TmV4dEFjaGlldmVtZW50cyh1c2VySWQ6IHN0cmluZykge1xuICBjb25zdCBuZXh0QWNoaWV2ZW1lbnRzID0gW11cbiAgXG4gIGZvciAoY29uc3QgW3R5cGUsIGRlZmluaXRpb25dIG9mIE9iamVjdC5lbnRyaWVzKEFDSElFVkVNRU5UX0RFRklOSVRJT05TKSkge1xuICAgIGxldCBjdXJyZW50VmFsdWUgPSAwXG4gICAgXG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlICdTVFVEWV9TVFJFQUsnOlxuICAgICAgICBjdXJyZW50VmFsdWUgPSBhd2FpdCBjYWxjdWxhdGVTdHVkeVN0cmVhayh1c2VySWQpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdQRUVSX0hFTFBFUic6XG4gICAgICAgIGN1cnJlbnRWYWx1ZSA9IGF3YWl0IGNvdW50SGVscGZ1bE1lc3NhZ2VzKHVzZXJJZClcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ1FVSVpfTUFTVEVSWSc6XG4gICAgICAgIGN1cnJlbnRWYWx1ZSA9IGF3YWl0IGNvdW50SGlnaFNjb3JlUXVpenplcyh1c2VySWQpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdTVFVEWV9HUk9VUF9MRUFERVInOlxuICAgICAgICBjdXJyZW50VmFsdWUgPSBhd2FpdCBjb3VudFN0dWR5R3JvdXBNZXNzYWdlcyh1c2VySWQpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdDSEFUX0VOR0FHRU1FTlQnOlxuICAgICAgICBjdXJyZW50VmFsdWUgPSBhd2FpdCBjb3VudFRvdGFsTWVzc2FnZXModXNlcklkKVxuICAgICAgICBicmVha1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBuZXh0TGV2ZWwgPSBkZWZpbml0aW9uLmxldmVscy5maW5kKGxldmVsID0+IGN1cnJlbnRWYWx1ZSA8IGxldmVsLnJlcXVpcmVtZW50KVxuICAgIFxuICAgIGlmIChuZXh0TGV2ZWwpIHtcbiAgICAgIG5leHRBY2hpZXZlbWVudHMucHVzaCh7XG4gICAgICAgIHR5cGUsXG4gICAgICAgIG5hbWU6IGRlZmluaXRpb24ubmFtZSxcbiAgICAgICAgZGVzY3JpcHRpb246IGRlZmluaXRpb24uZGVzY3JpcHRpb24sXG4gICAgICAgIG5leHRMZXZlbDogbmV4dExldmVsLmxldmVsLFxuICAgICAgICBuZXh0QmFkZ2U6IG5leHRMZXZlbC5iYWRnZSxcbiAgICAgICAgbmV4dFRpdGxlOiBuZXh0TGV2ZWwudGl0bGUsXG4gICAgICAgIHJlcXVpcmVtZW50OiBuZXh0TGV2ZWwucmVxdWlyZW1lbnQsXG4gICAgICAgIGN1cnJlbnRWYWx1ZSxcbiAgICAgICAgcHJvZ3Jlc3M6IChjdXJyZW50VmFsdWUgLyBuZXh0TGV2ZWwucmVxdWlyZW1lbnQpICogMTAwXG4gICAgICB9KVxuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIG5leHRBY2hpZXZlbWVudHNcbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJwcmlzbWEiLCJnZXRTZXNzaW9uIiwiQUNISUVWRU1FTlRfREVGSU5JVElPTlMiLCJTVFVEWV9TVFJFQUsiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJsZXZlbHMiLCJsZXZlbCIsInJlcXVpcmVtZW50IiwiYmFkZ2UiLCJ0aXRsZSIsIlBFRVJfSEVMUEVSIiwiUVVJWl9NQVNURVJZIiwiU1RVRFlfR1JPVVBfTEVBREVSIiwiQ0hBVF9FTkdBR0VNRU5UIiwiR0VUIiwicmVxdWVzdCIsInNlc3Npb24iLCJpZCIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsInVzZXJJZCIsImdldCIsImFjaGlldmVtZW50cyIsImNhbGN1bGF0ZVVzZXJBY2hpZXZlbWVudHMiLCJjb25zb2xlIiwic3R1ZHlTdHJlYWsiLCJjYWxjdWxhdGVTdHVkeVN0cmVhayIsInN0cmVha0FjaGlldmVtZW50IiwiZ2V0QWNoaWV2ZW1lbnRMZXZlbCIsInB1c2giLCJ0eXBlIiwiY3VycmVudFZhbHVlIiwiZWFybmVkQXQiLCJEYXRlIiwiaGVscGZ1bE1lc3NhZ2VzIiwiY291bnRIZWxwZnVsTWVzc2FnZXMiLCJoZWxwZXJBY2hpZXZlbWVudCIsImhpZ2hTY29yZUNvdW50IiwiY291bnRIaWdoU2NvcmVRdWl6emVzIiwibWFzdGVyeUFjaGlldmVtZW50Iiwic3R1ZHlHcm91cE1lc3NhZ2VzIiwiY291bnRTdHVkeUdyb3VwTWVzc2FnZXMiLCJsZWFkZXJBY2hpZXZlbWVudCIsInRvdGFsTWVzc2FnZXMiLCJjb3VudFRvdGFsTWVzc2FnZXMiLCJjaGF0QWNoaWV2ZW1lbnQiLCJ0b3RhbFBvaW50cyIsInJlZHVjZSIsInN1bSIsImFjaCIsIm5leHRBY2hpZXZlbWVudHMiLCJnZXROZXh0QWNoaWV2ZW1lbnRzIiwiYXR0ZW1wdHMiLCJxdWl6QXR0ZW1wdCIsImZpbmRNYW55Iiwid2hlcmUiLCJjb21wbGV0ZWRBdCIsIm5vdCIsIm9yZGVyQnkiLCJzZWxlY3QiLCJsZW5ndGgiLCJzdHJlYWsiLCJjdXJyZW50RGF0ZSIsInNldEhvdXJzIiwiYXR0ZW1wdCIsImF0dGVtcHREYXRlIiwiZGF5c0RpZmYiLCJNYXRoIiwiZmxvb3IiLCJnZXRUaW1lIiwiY2hhdE1lc3NhZ2UiLCJjb3VudCIsIk9SIiwiY29udGVudCIsImNvbnRhaW5zIiwicmVwbHlUb0lkIiwiaXNEZWxldGVkIiwiaGlnaFNjb3JlQXR0ZW1wdHMiLCJzY29yZSIsImd0ZSIsInJvb20iLCJpc1N5c3RlbU1lc3NhZ2UiLCJ2YWx1ZSIsImRlZmluaXRpb24iLCJmaWx0ZXIiLCJoaWdoZXN0TGV2ZWwiLCJPYmplY3QiLCJlbnRyaWVzIiwibmV4dExldmVsIiwiZmluZCIsIm5leHRCYWRnZSIsIm5leHRUaXRsZSIsInByb2dyZXNzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/gamification/achievements/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getSession: () => (/* binding */ getSession),\n/* harmony export */   requireAuth: () => (/* binding */ requireAuth),\n/* harmony export */   requireRole: () => (/* binding */ requireRole)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\nasync function getSession() {\n    try {\n        const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n        const sessionCookie = cookieStore.get(\"user-session\");\n        if (!sessionCookie || !sessionCookie.value) {\n            return null;\n        }\n        // Validate that the cookie value is not empty or malformed\n        if (sessionCookie.value.trim() === \"\") {\n            return null;\n        }\n        const session = JSON.parse(sessionCookie.value);\n        // Validate that the session has required fields\n        if (!session || !session.id || !session.email || !session.name || !session.role) {\n            console.warn(\"Invalid session structure:\", session);\n            return null;\n        }\n        return session;\n    } catch (error) {\n        console.error(\"Error getting session:\", error);\n        return null;\n    }\n}\nasync function requireAuth() {\n    const session = await getSession();\n    if (!session) {\n        throw new Error(\"Authentication required\");\n    }\n    return session;\n}\nasync function requireRole(role) {\n    const session = await requireAuth();\n    if (session.role !== role) {\n        throw new Error(`Access denied. Required role: ${role}`);\n    }\n    return session;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2F1dGgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFzQztBQVUvQixlQUFlQztJQUNwQixJQUFJO1FBQ0YsTUFBTUMsY0FBY0YscURBQU9BO1FBQzNCLE1BQU1HLGdCQUFnQkQsWUFBWUUsR0FBRyxDQUFDO1FBRXRDLElBQUksQ0FBQ0QsaUJBQWlCLENBQUNBLGNBQWNFLEtBQUssRUFBRTtZQUMxQyxPQUFPO1FBQ1Q7UUFFQSwyREFBMkQ7UUFDM0QsSUFBSUYsY0FBY0UsS0FBSyxDQUFDQyxJQUFJLE9BQU8sSUFBSTtZQUNyQyxPQUFPO1FBQ1Q7UUFFQSxNQUFNQyxVQUFVQyxLQUFLQyxLQUFLLENBQUNOLGNBQWNFLEtBQUs7UUFFOUMsZ0RBQWdEO1FBQ2hELElBQUksQ0FBQ0UsV0FBVyxDQUFDQSxRQUFRRyxFQUFFLElBQUksQ0FBQ0gsUUFBUUksS0FBSyxJQUFJLENBQUNKLFFBQVFLLElBQUksSUFBSSxDQUFDTCxRQUFRTSxJQUFJLEVBQUU7WUFDL0VDLFFBQVFDLElBQUksQ0FBQyw4QkFBOEJSO1lBQzNDLE9BQU87UUFDVDtRQUVBLE9BQU9BO0lBQ1QsRUFBRSxPQUFPUyxPQUFPO1FBQ2RGLFFBQVFFLEtBQUssQ0FBQywwQkFBMEJBO1FBQ3hDLE9BQU87SUFDVDtBQUNGO0FBRU8sZUFBZUM7SUFDcEIsTUFBTVYsVUFBVSxNQUFNTjtJQUN0QixJQUFJLENBQUNNLFNBQVM7UUFDWixNQUFNLElBQUlXLE1BQU07SUFDbEI7SUFDQSxPQUFPWDtBQUNUO0FBRU8sZUFBZVksWUFBWU4sSUFBYztJQUM5QyxNQUFNTixVQUFVLE1BQU1VO0lBQ3RCLElBQUlWLFFBQVFNLElBQUksS0FBS0EsTUFBTTtRQUN6QixNQUFNLElBQUlLLE1BQU0sQ0FBQyw4QkFBOEIsRUFBRUwsS0FBSyxDQUFDO0lBQ3pEO0lBQ0EsT0FBT047QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3F1aXotbWFuYWdlbWVudC1zeXN0ZW0vLi9zcmMvbGliL2F1dGgudHM/NjY5MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb29raWVzIH0gZnJvbSAnbmV4dC9oZWFkZXJzJ1xuaW1wb3J0IHsgVXNlclJvbGUgfSBmcm9tICdAL3R5cGVzJ1xuXG5leHBvcnQgaW50ZXJmYWNlIFNlc3Npb25Vc2VyIHtcbiAgaWQ6IHN0cmluZ1xuICBlbWFpbDogc3RyaW5nXG4gIG5hbWU6IHN0cmluZ1xuICByb2xlOiBVc2VyUm9sZVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2Vzc2lvbigpOiBQcm9taXNlPFNlc3Npb25Vc2VyIHwgbnVsbD4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNvb2tpZVN0b3JlID0gY29va2llcygpXG4gICAgY29uc3Qgc2Vzc2lvbkNvb2tpZSA9IGNvb2tpZVN0b3JlLmdldCgndXNlci1zZXNzaW9uJylcbiAgICBcbiAgICBpZiAoIXNlc3Npb25Db29raWUgfHwgIXNlc3Npb25Db29raWUudmFsdWUpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgLy8gVmFsaWRhdGUgdGhhdCB0aGUgY29va2llIHZhbHVlIGlzIG5vdCBlbXB0eSBvciBtYWxmb3JtZWRcbiAgICBpZiAoc2Vzc2lvbkNvb2tpZS52YWx1ZS50cmltKCkgPT09ICcnKSB7XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cblxuICAgIGNvbnN0IHNlc3Npb24gPSBKU09OLnBhcnNlKHNlc3Npb25Db29raWUudmFsdWUpXG4gICAgXG4gICAgLy8gVmFsaWRhdGUgdGhhdCB0aGUgc2Vzc2lvbiBoYXMgcmVxdWlyZWQgZmllbGRzXG4gICAgaWYgKCFzZXNzaW9uIHx8ICFzZXNzaW9uLmlkIHx8ICFzZXNzaW9uLmVtYWlsIHx8ICFzZXNzaW9uLm5hbWUgfHwgIXNlc3Npb24ucm9sZSkge1xuICAgICAgY29uc29sZS53YXJuKCdJbnZhbGlkIHNlc3Npb24gc3RydWN0dXJlOicsIHNlc3Npb24pXG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cblxuICAgIHJldHVybiBzZXNzaW9uXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBzZXNzaW9uOicsIGVycm9yKVxuICAgIHJldHVybiBudWxsXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVBdXRoKCk6IFByb21pc2U8U2Vzc2lvblVzZXI+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb24oKVxuICBpZiAoIXNlc3Npb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJylcbiAgfVxuICByZXR1cm4gc2Vzc2lvblxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVJvbGUocm9sZTogVXNlclJvbGUpOiBQcm9taXNlPFNlc3Npb25Vc2VyPiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCByZXF1aXJlQXV0aCgpXG4gIGlmIChzZXNzaW9uLnJvbGUgIT09IHJvbGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEFjY2VzcyBkZW5pZWQuIFJlcXVpcmVkIHJvbGU6ICR7cm9sZX1gKVxuICB9XG4gIHJldHVybiBzZXNzaW9uXG59XG4iXSwibmFtZXMiOlsiY29va2llcyIsImdldFNlc3Npb24iLCJjb29raWVTdG9yZSIsInNlc3Npb25Db29raWUiLCJnZXQiLCJ2YWx1ZSIsInRyaW0iLCJzZXNzaW9uIiwiSlNPTiIsInBhcnNlIiwiaWQiLCJlbWFpbCIsIm5hbWUiLCJyb2xlIiwiY29uc29sZSIsIndhcm4iLCJlcnJvciIsInJlcXVpcmVBdXRoIiwiRXJyb3IiLCJyZXF1aXJlUm9sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsR0FBRTtBQUVsRSxJQUFJSSxJQUF5QixFQUFjSCxnQkFBZ0JFLE1BQU0sR0FBR0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9xdWl6LW1hbmFnZW1lbnQtc3lzdGVtLy4vc3JjL2xpYi9wcmlzbWEudHM/MDFkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gbmV3IFByaXNtYUNsaWVudCgpXG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hXG4iXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsInByb2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fgamification%2Fachievements%2Froute&page=%2Fapi%2Fgamification%2Fachievements%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fgamification%2Fachievements%2Froute.ts&appDir=C%3A%5CUsers%5CHP%5CDocuments%5CInfTech-quiz-management-system%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CHP%5CDocuments%5CInfTech-quiz-management-system&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();